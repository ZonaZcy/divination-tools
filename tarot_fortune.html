<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¡”ç½—ç‰Œå åœ - Tarot Reading</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'SimSun', serif;
            background: linear-gradient(135deg, #2C1654 0%, #4A235A 50%, #2C1654 100%);
            color: #F4E4C1;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 2px solid #D4AF37;
            margin-bottom: 40px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }

        h1 {
            font-size: 3.5em;
            color: #D4AF37;
            text-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
            margin-bottom: 15px;
            letter-spacing: 6px;
        }

        .subtitle {
            font-size: 1.3em;
            color: #F4E4C1;
            font-style: italic;
            letter-spacing: 3px;
        }

        .input-section {
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid #D4AF37;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-size: 1.2em;
            color: #D4AF37;
            font-weight: bold;
        }

        .input-group textarea {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid #8E44AD;
            border-radius: 10px;
            color: #F4E4C1;
            font-size: 1.1em;
            font-family: 'Georgia', 'SimSun', serif;
            resize: vertical;
            min-height: 80px;
            transition: all 0.3s;
        }

        .input-group textarea:focus {
            outline: none;
            border-color: #D4AF37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
        }

        .spread-selection {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
        }

        .spread-option {
            background: rgba(142, 68, 173, 0.3);
            border: 2px solid #8E44AD;
            border-radius: 10px;
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s;
            color: #F4E4C1;
            font-size: 1.1em;
        }

        .spread-option:hover {
            background: rgba(142, 68, 173, 0.5);
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(142, 68, 173, 0.4);
        }

        .spread-option.active {
            background: linear-gradient(135deg, #8E44AD, #D4AF37);
            border-color: #D4AF37;
            box-shadow: 0 0 25px rgba(212, 175, 55, 0.5);
        }

        .start-button {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #8E44AD 0%, #D4AF37 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            letter-spacing: 4px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .start-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.5);
        }

        .start-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .card-selection-area {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #D4AF37;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            display: none;
        }

        .selection-info {
            text-align: center;
            margin-bottom: 25px;
        }

        .selection-info h2 {
            color: #D4AF37;
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .selection-count {
            font-size: 1.3em;
            color: #FFD700;
            font-weight: bold;
        }

        .card-deck {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
            max-height: 600px;
            overflow-y: auto;
            padding: 20px;
        }

        .card-back {
            width: 100px;
            height: 160px;
            background: linear-gradient(135deg, #4A235A, #2C1654);
            border: 3px solid #8E44AD;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .card-back::before {
            content: 'âœ¦';
            font-size: 3em;
            color: #D4AF37;
            text-shadow: 0 0 15px rgba(212, 175, 55, 0.8);
        }

        .card-back:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.4);
            border-color: #D4AF37;
        }

        .card-back.selected {
            background: linear-gradient(135deg, #27AE60, #229954);
            border-color: #FFD700;
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.6);
        }

        .card-back.selected::after {
            content: 'âœ“';
            position: absolute;
            top: 5px;
            right: 5px;
            width: 25px;
            height: 25px;
            background: #FFD700;
            color: #2C1654;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }

        .card-position-label {
            text-align: center;
            margin-top: 8px;
            font-size: 0.85em;
            color: #FFD700;
            font-weight: bold;
            min-height: 20px;
        }

        .confirm-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #27AE60, #229954);
            border: 2px solid #FFD700;
            border-radius: 12px;
            color: white;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            letter-spacing: 3px;
        }

        .confirm-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(39, 174, 96, 0.5);
        }

        .confirm-button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .results-area {
            display: none;
        }

        .drawn-cards {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }

        .card-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .tarot-card {
            width: 180px;
            height: 280px;
            background: linear-gradient(135deg, #F4E4C1, #E8D4A8);
            border: 4px solid #8E44AD;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            position: relative;
            animation: cardReveal 0.8s ease-out;
            transition: all 0.3s;
        }

        .tarot-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 15px 40px rgba(212, 175, 55, 0.6);
        }

        .tarot-card.reversed {
            transform: rotate(180deg);
            border-color: #E74C3C;
        }

        .tarot-card.reversed:hover {
            transform: rotate(180deg) translateY(-10px) scale(1.05);
        }

        @keyframes cardReveal {
            from {
                opacity: 0;
                transform: rotateY(180deg) scale(0.5);
            }
            to {
                opacity: 1;
                transform: rotateY(0) scale(1);
            }
        }

        .card-suit {
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .card-name {
            font-size: 1em;
            font-weight: bold;
            color: #2C1654;
            text-align: center;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .card-keywords {
            display: flex;
            flex-direction: column;
            gap: 5px;
            align-items: center;
            flex-grow: 1;
            justify-content: center;
        }

        .keyword {
            background: rgba(142, 68, 173, 0.2);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            color: #8E44AD;
            font-weight: bold;
        }

        .card-status {
            background: #8E44AD;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.95em;
            margin-top: 10px;
        }

        .card-status.reversed-status {
            background: #E74C3C;
        }

        .card-position {
            font-size: 1.2em;
            color: #D4AF37;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
        }

        .interpretation {
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid #D4AF37;
            border-radius: 15px;
            padding: 30px;
            line-height: 1.8;
        }

        .interpretation h2 {
            color: #D4AF37;
            font-size: 2em;
            margin-bottom: 20px;
            text-align: center;
            letter-spacing: 3px;
        }

        .interpretation h3 {
            color: #8E44AD;
            font-size: 1.5em;
            margin: 25px 0 15px 0;
            border-bottom: 2px solid #8E44AD;
            padding-bottom: 10px;
        }

        .interpretation p {
            margin-bottom: 15px;
            font-size: 1.1em;
            text-indent: 2em;
        }

        .card-detail {
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid #D4AF37;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .card-detail strong {
            color: #FFD700;
        }

        .summary-section {
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid #D4AF37;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
        }

        .summary-section h3 {
            color: #D4AF37;
            text-align: center;
            border: none;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5em;
                letter-spacing: 3px;
            }

            .spread-selection {
                flex-direction: column;
            }

            .card-deck {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }

            .card-back {
                width: 80px;
                height: 130px;
            }

            .tarot-card {
                width: 150px;
                height: 240px;
            }

            .drawn-cards {
                flex-direction: column;
                align-items: center;
            }
        }

        .info-section {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #8E44AD;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }

        .info-section h3 {
            color: #D4AF37;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .info-section p {
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .card-deck::-webkit-scrollbar {
            width: 10px;
        }

        .card-deck::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
        }

        .card-deck::-webkit-scrollbar-thumb {
            background: #8E44AD;
            border-radius: 5px;
        }

        .card-deck::-webkit-scrollbar-thumb:hover {
            background: #D4AF37;
        }

        .new-reading-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #3498DB, #2980B9);
            border: 2px solid #D4AF37;
            border-radius: 10px;
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 30px;
            letter-spacing: 2px;
            transition: all 0.3s;
        }

        .new-reading-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(52, 152, 219, 0.5);
        }

        .ai-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #3498DB, #2980B9);
            border: 2px solid #D4AF37;
            border-radius: 12px;
            color: white;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            letter-spacing: 3px;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .ai-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(52, 152, 219, 0.6);
            background: linear-gradient(135deg, #5DADE2, #3498DB);
        }

        .ai-button::before {
            content: 'ğŸ¤–';
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>âœ¨ å¡”ç½—ç‰Œå åœ âœ¨</h1>
            <p class="subtitle">è†å¬å†…å¿ƒçš„å£°éŸ³ï¼Œæ¢ç´¢å‘½è¿çš„æŒ‡å¼•</p>
        </header>

        <div class="input-section" id="inputSection">
            <div class="input-group">
                <label for="question">ğŸŒ™ è¯·è¾“å…¥ä½ çš„é—®é¢˜ï¼š</label>
                <textarea id="question" placeholder="é™å¿ƒå‡ç¥ï¼Œè¯šå¿ƒæ±‚é—®..."></textarea>
            </div>

            <div class="input-group">
                <label>ğŸ”® é€‰æ‹©ç‰Œé˜µï¼š</label>
                <div class="spread-selection" id="spreadSelection">
                    <div class="spread-option" data-spread="single">å•å¼ ç‰Œ (1å¼ )</div>
                    <div class="spread-option active" data-spread="three">ä¸‰ç‰Œé˜µ (3å¼ )</div>
                    <div class="spread-option" data-spread="celtic">å‡¯å°”ç‰¹åå­— (10å¼ )</div>
                    <div class="spread-option" data-spread="love">çˆ±æƒ…ç‰Œé˜µ (5å¼ )</div>
                    <div class="spread-option" data-spread="work">å·¥ä½œç‰Œé˜µ (4å¼ )</div>
                </div>
            </div>

            <button class="start-button" id="startButton">ğŸ”® å¼€å§‹å åœ</button>
        </div>

        <div class="card-selection-area" id="cardSelectionArea">
            <div class="selection-info">
                <h2>âœ¨ å‡­ç›´è§‰é€‰æ‹©å¡”ç½—ç‰Œ âœ¨</h2>
                <p class="selection-count" id="selectionCount">å·²é€‰: 0 / 3</p>
            </div>
            <div class="card-deck" id="cardDeck"></div>
            <button class="confirm-button" id="confirmButton" disabled>âœ“ ç¡®è®¤é€‰æ‹©</button>
        </div>

        <div class="results-area" id="resultsArea">
            <div class="drawn-cards" id="drawnCards"></div>
            <div class="interpretation" id="interpretation"></div>
            <button class="ai-button" id="aiButton">AI æ·±åº¦è§£è¯»</button>
            <button class="new-reading-button" id="newReadingButton">ğŸŒŸ å¼€å§‹æ–°çš„å åœ</button>
        </div>

        <div class="info-section">
            <h3>ğŸ“– å…³äºå¡”ç½—ç‰Œ</h3>
            <p>å¡”ç½—ç‰Œæ˜¯ä¸€ç§å¤è€çš„å åœå·¥å…·ï¼Œç”±78å¼ ç‰Œç»„æˆï¼Œåˆ†ä¸ºå¤§é˜¿å°”å¡é‚£ï¼ˆ22å¼ ï¼‰å’Œå°é˜¿å°”å¡é‚£ï¼ˆ56å¼ ï¼‰ã€‚</p>
            <p><strong>å¤§é˜¿å°”å¡é‚£</strong>ä»£è¡¨äººç”Ÿçš„é‡å¤§è¯¾é¢˜å’Œçµæ€§æˆé•¿ï¼Œ<strong>å°é˜¿å°”å¡é‚£</strong>åˆ™åæ˜ æ—¥å¸¸ç”Ÿæ´»çš„å„ä¸ªæ–¹é¢ã€‚</p>
            <p>å¡”ç½—ç‰Œä¸æ˜¯é¢„æµ‹å‘½è¿çš„ç»å¯¹å·¥å…·ï¼Œè€Œæ˜¯å¸®åŠ©ä½ æ›´å¥½åœ°è®¤è¯†è‡ªå·±ã€ç†è§£å½“ä¸‹ã€åšå‡ºæ˜æ™ºé€‰æ‹©çš„æŒ‡å¼•ã€‚</p>
            <p style="margin-top: 15px; color: #D4AF37; font-style: italic;">âœ¨ è¯šå¿ƒæ±‚é—®ï¼Œé™å¿ƒé¢†æ‚Ÿ âœ¨</p>
        </div>
    </div>

    <script>
        // å¡”ç½—ç‰Œæ•°æ®
        const TAROT_DECK = [
            // å¤§é˜¿å°”å¡é‚£
            { name: "æ„šè€…", suit: "Major Arcana", symbol: "â˜…", upright: "æ–°çš„å¼€å§‹ã€å†’é™©ã€å¤©çœŸã€è‡ªç”±ã€æ½œèƒ½", reversed: "é²è½ã€å†²åŠ¨ã€ç¼ºä¹æ–¹å‘ã€æ„šè ¢çš„å†³å®š", keywords: ["å¼€å§‹", "å†’é™©", "è‡ªç”±"] },
            { name: "é­”æœ¯å¸ˆ", suit: "Major Arcana", symbol: "â˜…", upright: "åˆ›é€ åŠ›ã€æŠ€èƒ½ã€æ„å¿—åŠ›ã€è¡ŒåŠ¨ã€æ˜¾åŒ–", reversed: "æ“çºµã€æ¬ºéª—ã€æŠ€èƒ½æ»¥ç”¨ã€ç¼ºä¹è‡ªä¿¡", keywords: ["åˆ›é€ ", "æŠ€èƒ½", "è¡ŒåŠ¨"] },
            { name: "å¥³ç¥­å¸", suit: "Major Arcana", symbol: "â˜…", upright: "ç›´è§‰ã€ç¥ç§˜ã€æ½œæ„è¯†ã€æ™ºæ…§ã€å†…åœ¨çŸ¥è¯†", reversed: "ç§˜å¯†ã€éšè—çš„è®®ç¨‹ã€ç¼ºä¹ä¸ªäººå’Œè°", keywords: ["ç›´è§‰", "æ™ºæ…§", "ç¥ç§˜"] },
            { name: "çš‡å", suit: "Major Arcana", symbol: "â˜…", upright: "ä¸°é¥¶ã€æ¯æ€§ã€è‡ªç„¶ã€åˆ›é€ åŠ›ã€å¯Œè¶³", reversed: "ä¾èµ–ã€çª’æ¯ã€ç¼ºä¹æˆé•¿", keywords: ["ä¸°é¥¶", "æ¯æ€§", "åˆ›é€ "] },
            { name: "çš‡å¸", suit: "Major Arcana", symbol: "â˜…", upright: "æƒå¨ã€ç»“æ„ã€æ§åˆ¶ã€çˆ¶æ€§ã€ç¨³å®š", reversed: "ä¸“åˆ¶ã€æ­»æ¿ã€ç¼ºä¹çºªå¾‹", keywords: ["æƒå¨", "ç¨³å®š", "æ§åˆ¶"] },
            { name: "æ•™çš‡", suit: "Major Arcana", symbol: "â˜…", upright: "ä¼ ç»Ÿã€ç²¾ç¥æ™ºæ…§ã€å¯¼å¸ˆã€ä¿¡ä»°ã€åˆ¶åº¦", reversed: "å›é€†ã€é¢ è¦†ã€æ–°æ–¹æ³•", keywords: ["ä¼ ç»Ÿ", "æ™ºæ…§", "ä¿¡ä»°"] },
            { name: "æ‹äºº", suit: "Major Arcana", symbol: "â˜…", upright: "çˆ±æƒ…ã€å’Œè°ã€å…³ç³»ã€ä»·å€¼è§‚ã€é€‰æ‹©", reversed: "å¤±è¡¡ã€ä¸å’Œè°ã€ç¼ºä¹è´£ä»»", keywords: ["çˆ±æƒ…", "é€‰æ‹©", "å’Œè°"] },
            { name: "æˆ˜è½¦", suit: "Major Arcana", symbol: "â˜…", upright: "æ„å¿—ã€å†³å¿ƒã€èƒœåˆ©ã€æ§åˆ¶ã€è¿›æ­¥", reversed: "å¤±æ§ã€æ–¹å‘ä¸æ˜ã€ä¾µç•¥", keywords: ["èƒœåˆ©", "æ„å¿—", "æ§åˆ¶"] },
            { name: "åŠ›é‡", suit: "Major Arcana", symbol: "â˜…", upright: "å‹‡æ°”ã€è€å¿ƒã€æ§åˆ¶ã€åŒæƒ…ã€å†…åœ¨åŠ›é‡", reversed: "è‡ªæˆ‘æ€€ç–‘ã€ç¼ºä¹è‡ªä¿¡ã€è½¯å¼±", keywords: ["å‹‡æ°”", "åŠ›é‡", "è€å¿ƒ"] },
            { name: "éšè€…", suit: "Major Arcana", symbol: "â˜…", upright: "å†…çœã€ç‹¬å¤„ã€å¯»æ±‚çœŸç†ã€æŒ‡å¼•ã€æ™ºæ…§", reversed: "å­¤ç«‹ã€å­¤ç‹¬ã€é€€ç¼©", keywords: ["å†…çœ", "æ™ºæ…§", "ç‹¬å¤„"] },
            { name: "å‘½è¿ä¹‹è½®", suit: "Major Arcana", symbol: "â˜…", upright: "å˜åŒ–ã€å¾ªç¯ã€å‘½è¿ã€å¥½è¿ã€è½¬æŠ˜ç‚¹", reversed: "å„è¿ã€æŠµæŠ—å˜åŒ–ã€å¤±æ§", keywords: ["å˜åŒ–", "å‘½è¿", "å¾ªç¯"] },
            { name: "æ­£ä¹‰", suit: "Major Arcana", symbol: "â˜…", upright: "å…¬æ­£ã€çœŸç›¸ã€å› æœã€æ³•å¾‹ã€è¯šå®", reversed: "ä¸å…¬ã€ä¸è¯šå®ã€é€ƒé¿è´£ä»»", keywords: ["å…¬æ­£", "çœŸç›¸", "å¹³è¡¡"] },
            { name: "å€’åŠäºº", suit: "Major Arcana", symbol: "â˜…", upright: "æ”¾æ‰‹ã€æ–°è§†è§’ã€æš‚åœã€ç‰ºç‰²ã€ç­‰å¾…", reversed: "å»¶è¿Ÿã€æŠµæŠ—ã€åœæ»", keywords: ["æ”¾æ‰‹", "è§†è§’", "ç­‰å¾…"] },
            { name: "æ­»ç¥", suit: "Major Arcana", symbol: "â˜…", upright: "ç»“æŸã€è½¬å˜ã€è¿‡æ¸¡ã€é‡Šæ”¾ã€é‡ç”Ÿ", reversed: "æŠµæŠ—å˜åŒ–ã€æ— æ³•æ”¾æ‰‹ã€åœæ»", keywords: ["è½¬å˜", "ç»“æŸ", "é‡ç”Ÿ"] },
            { name: "èŠ‚åˆ¶", suit: "Major Arcana", symbol: "â˜…", upright: "å¹³è¡¡ã€èŠ‚åˆ¶ã€è€å¿ƒã€ç›®æ ‡ã€å’Œè°", reversed: "å¤±è¡¡ã€è¿‡åº¦ã€ç¼ºä¹è¿œè§", keywords: ["å¹³è¡¡", "å’Œè°", "èŠ‚åˆ¶"] },
            { name: "æ¶é­”", suit: "Major Arcana", symbol: "â˜…", upright: "æŸç¼šã€æˆç˜¾ã€ç‰©è´¨ä¸»ä¹‰ã€é˜´å½±è‡ªæˆ‘", reversed: "é‡Šæ”¾ã€è§£è„±ã€æŒ£è„±æŸç¼š", keywords: ["æŸç¼š", "æ¬²æœ›", "ç‰©è´¨"] },
            { name: "å¡”", suit: "Major Arcana", symbol: "â˜…", upright: "çªç„¶æ”¹å˜ã€åŠ¨è¡ã€æ··ä¹±ã€å¯ç¤ºã€è§‰é†’", reversed: "é¿å…ç¾éš¾ã€ææƒ§æ”¹å˜ã€ä¸ªäººè½¬å˜", keywords: ["æ”¹å˜", "åŠ¨è¡", "è§‰é†’"] },
            { name: "æ˜Ÿæ˜Ÿ", suit: "Major Arcana", symbol: "â˜…", upright: "å¸Œæœ›ã€ä¿¡ä»°ã€çµæ„Ÿã€å®é™ã€ç–—æ„ˆ", reversed: "ç»æœ›ã€ç¼ºä¹ä¿¡ä»°ã€å¤±æœ›", keywords: ["å¸Œæœ›", "çµæ„Ÿ", "ç–—æ„ˆ"] },
            { name: "æœˆäº®", suit: "Major Arcana", symbol: "â˜…", upright: "å¹»è±¡ã€ææƒ§ã€ç„¦è™‘ã€æ½œæ„è¯†ã€ç›´è§‰", reversed: "é‡Šæ”¾ææƒ§ã€å‹æŠ‘ã€å†…å¿ƒæ··ä¹±", keywords: ["å¹»è±¡", "ç›´è§‰", "ææƒ§"] },
            { name: "å¤ªé˜³", suit: "Major Arcana", symbol: "â˜…", upright: "å¿«ä¹ã€æˆåŠŸã€åº†ç¥ã€ç§¯æã€æ´»åŠ›", reversed: "æš‚æ—¶ä½è¿·ã€æ‚²è§‚ã€ç¼ºä¹æˆåŠŸ", keywords: ["å¿«ä¹", "æˆåŠŸ", "æ´»åŠ›"] },
            { name: "å®¡åˆ¤", suit: "Major Arcana", symbol: "â˜…", upright: "åˆ¤æ–­ã€é‡ç”Ÿã€å†…åœ¨å‘¼å”¤ã€å®½æ•ã€è§‰é†’", reversed: "è‡ªæˆ‘æ€€ç–‘ã€æ‹’ç»è´£ä»»ã€å†…ç–š", keywords: ["é‡ç”Ÿ", "è§‰é†’", "å®½æ•"] },
            { name: "ä¸–ç•Œ", suit: "Major Arcana", symbol: "â˜…", upright: "å®Œæˆã€æˆå°±ã€æ—…è¡Œã€æ•´åˆã€æ»¡è¶³", reversed: "æœªå®Œæˆã€ç¼ºä¹é—­åˆã€å¯»æ±‚ä¸ªäººé—­åˆ", keywords: ["å®Œæˆ", "æˆå°±", "æ•´åˆ"] },
            // æƒæ–ç‰Œç»„ (ç®€åŒ–ï¼Œæ·»åŠ éƒ¨åˆ†ä»£è¡¨æ€§ç‰Œ)
            { name: "æƒæ–1", suit: "Wands", symbol: "ğŸ”¥", upright: "åˆ›é€ åŠ›å¼€å§‹ã€æ–°æœºä¼šã€çµæ„Ÿã€æˆé•¿", reversed: "å»¶è¿Ÿã€ç¼ºä¹æ–¹å‘ã€åˆ›é€ åŠ›å—é˜»", keywords: ["æ¿€æƒ…", "è¡ŒåŠ¨", "åˆ›é€ "] },
            { name: "æƒæ–2", suit: "Wands", symbol: "ğŸ”¥", upright: "è®¡åˆ’ã€å†³ç­–ã€æœªæ¥å±•æœ›ã€ä¸ªäººç›®æ ‡", reversed: "çŠ¹è±«ä¸å†³ã€å®³æ€•æœªçŸ¥ã€ç¼ºä¹è®¡åˆ’", keywords: ["å†³ç­–", "å±•æœ›", "è®¡åˆ’"] },
            { name: "æƒæ–3", suit: "Wands", symbol: "ğŸ”¥", upright: "æ‰©å¼ ã€è¿œè§ã€é¢†å¯¼åŠ›ã€æœºä¼š", reversed: "ç¼ºä¹è¿œè§ã€å»¶è¿Ÿã€éšœç¢", keywords: ["æ‰©å¼ ", "è¿œè§", "æœºä¼š"] },
            { name: "æƒæ–éª‘å£«", suit: "Wands", symbol: "ğŸ”¥", upright: "èƒ½é‡ã€æ¿€æƒ…ã€å†²åŠ¨ã€å†’é™©", reversed: "é²è½ã€æ— è€å¿ƒã€å†²åŠ¨è¡Œäº‹", keywords: ["å†’é™©", "æ¿€æƒ…", "å†²åŠ¨"] },
            { name: "æƒæ–å›½ç‹", suit: "Wands", symbol: "ğŸ”¥", upright: "è‡ªç„¶é¢†å¯¼è€…ã€è¿œè§ã€ä¼ä¸šå®¶", reversed: "ç‹¬æ–­ã€ç²—æš´ã€æ— æƒ…", keywords: ["é¢†å¯¼", "è¿œè§", "è£èª‰"] },
            // åœ£æ¯ç‰Œç»„
            { name: "åœ£æ¯1", suit: "Cups", symbol: "ğŸ’§", upright: "æ–°çš„çˆ±æƒ…ã€æƒ…æ„Ÿå¼€å§‹ã€åˆ›é€ æ€§è¡¨è¾¾", reversed: "æƒ…æ„Ÿå°é—­ã€å‹æŠ‘æ„Ÿæƒ…ã€åˆ›é€ åŠ›å—é˜»", keywords: ["æƒ…æ„Ÿ", "çˆ±æƒ…", "ç›´è§‰"] },
            { name: "åœ£æ¯2", suit: "Cups", symbol: "ğŸ’§", upright: "ç»Ÿä¸€ã€ä¼™ä¼´å…³ç³»ã€å¸å¼•ã€å¹³è¡¡å…³ç³»", reversed: "ä¸å¹³è¡¡å…³ç³»ã€åˆ†ç¦»ã€ç´§å¼ ", keywords: ["ä¼™ä¼´", "å’Œè°", "å¸å¼•"] },
            { name: "åœ£æ¯3", suit: "Cups", symbol: "ğŸ’§", upright: "åº†ç¥ã€å‹è°Šã€åˆ›é€ åŠ›ã€ç¤¾åŒº", reversed: "è¿‡åº¦æ”¾çºµã€å­¤ç«‹ã€ç¼ºä¹åˆ›é€ ", keywords: ["åº†ç¥", "å‹è°Š", "æ¬¢ä¹"] },
            { name: "åœ£æ¯éª‘å£«", suit: "Cups", symbol: "ğŸ’§", upright: "æµªæ¼«ã€é­…åŠ›ã€æƒ³è±¡åŠ›ã€ç¾å¥½æè®®", reversed: "ä¸åˆ‡å®é™…ã€æƒ…ç»ªåŒ–ã€å–œæ€’æ— å¸¸", keywords: ["æµªæ¼«", "é­…åŠ›", "æƒ³è±¡"] },
            { name: "åœ£æ¯å›½ç‹", suit: "Cups", symbol: "ğŸ’§", upright: "æƒ…æ„Ÿå¹³è¡¡ã€æ§åˆ¶ã€æ…·æ…¨ã€å¤–äº¤", reversed: "æƒ…ç»ªæ“çºµã€æ³¢åŠ¨ã€ç¼ºä¹åŒæƒ…", keywords: ["å¹³è¡¡", "æ…·æ…¨", "å¤–äº¤"] },
            // å®å‰‘ç‰Œç»„
            { name: "å®å‰‘1", suit: "Swords", symbol: "âš”ï¸", upright: "çªç ´ã€æ¸…æ™°ã€æ–°æƒ³æ³•ã€å¿ƒæ™ºåŠ›é‡", reversed: "å›°æƒ‘ã€æ··ä¹±ã€æ€ç»´å—é™", keywords: ["æ™ºæ…§", "æ¸…æ™°", "çœŸç›¸"] },
            { name: "å®å‰‘2", suit: "Swords", symbol: "âš”ï¸", upright: "è‰°éš¾æŠ‰æ‹©ã€åƒµå±€ã€æƒè¡¡åˆ©å¼Š", reversed: "çŠ¹è±«ä¸å†³ã€ä¿¡æ¯è¿‡è½½ã€å›°æƒ‘", keywords: ["æŠ‰æ‹©", "å¹³è¡¡", "åƒµå±€"] },
            { name: "å®å‰‘3", suit: "Swords", symbol: "âš”ï¸", upright: "å¿ƒç¢ã€æ‚²ä¼¤ã€ç—›è‹¦ã€å¤±è½", reversed: "æ¢å¤ã€å®½æ•ã€èµ°å‡ºæ‚²ä¼¤", keywords: ["æ‚²ä¼¤", "ç—›è‹¦", "å¤±è½"] },
            { name: "å®å‰‘éª‘å£«", suit: "Swords", symbol: "âš”ï¸", upright: "é›„å¿ƒã€è¡ŒåŠ¨å¯¼å‘ã€å†²åŠ¨ã€ä¿å«ä¿¡å¿µ", reversed: "é²è½ã€ç¼ºä¹è®¡åˆ’ã€å†²åŠ¨", keywords: ["é›„å¿ƒ", "è¡ŒåŠ¨", "ä¿¡å¿µ"] },
            { name: "å®å‰‘å›½ç‹", suit: "Swords", symbol: "âš”ï¸", upright: "æ™ºåŠ›ã€ç†æ€§ã€é“å¾·ã€çœŸç›¸ã€æƒå¨", reversed: "æ“çºµã€æ®‹é…·ã€ç¼ºä¹åŒæƒ…", keywords: ["æ™ºåŠ›", "çœŸç›¸", "æƒå¨"] },
            // æ˜Ÿå¸ç‰Œç»„
            { name: "æ˜Ÿå¸1", suit: "Pentacles", symbol: "ğŸŒŸ", upright: "æ–°çš„è´¢åŠ¡æœºä¼šã€ç¹è£ã€å®‰å…¨", reversed: "å¤±å»æœºä¼šã€ç¼ºä¹è®¡åˆ’ã€è´ªå©ª", keywords: ["ç‰©è´¨", "æœºä¼š", "ç¹è£"] },
            { name: "æ˜Ÿå¸2", suit: "Pentacles", symbol: "ğŸŒŸ", upright: "å¹³è¡¡ã€é€‚åº”ã€çµæ´»ã€æ—¶é—´ç®¡ç†", reversed: "å¤±è¡¡ã€è¿‡åº¦æ‰¿è¯ºã€æ··ä¹±", keywords: ["å¹³è¡¡", "çµæ´»", "é€‚åº”"] },
            { name: "æ˜Ÿå¸3", suit: "Pentacles", symbol: "ğŸŒŸ", upright: "å›¢é˜Ÿåˆä½œã€å­¦ä¹ ã€å®æ–½", reversed: "ç¼ºä¹å›¢é˜Ÿåˆä½œã€æŠ€èƒ½ä¸è¶³", keywords: ["åˆä½œ", "å­¦ä¹ ", "æŠ€èƒ½"] },
            { name: "æ˜Ÿå¸éª‘å£«", suit: "Pentacles", symbol: "ğŸŒŸ", upright: "æ•ˆç‡ã€æ—¥å¸¸å·¥ä½œã€ä¿å®ˆã€å®ç”¨", reversed: "æ‡’æƒ°ã€æ²‰é—·ã€ä¸è´Ÿè´£ä»»", keywords: ["æ•ˆç‡", "å®ç”¨", "å·¥ä½œ"] },
            { name: "æ˜Ÿå¸å›½ç‹", suit: "Pentacles", symbol: "ğŸŒŸ", upright: "å¯Œè¶³ã€å®‰å…¨ã€é¢†å¯¼åŠ›ã€æˆåŠŸ", reversed: "è´ªå©ªã€æ”¾çºµã€æ„Ÿå®˜ä¸»ä¹‰", keywords: ["å¯Œè¶³", "æˆåŠŸ", "é¢†å¯¼"] }
        ];

        // ç‰Œé˜µå®šä¹‰
        const SPREADS = {
            single: { count: 1, name: "å•å¼ ç‰Œ", positions: ["å½“å‰çŠ¶å†µ"] },
            three: { count: 3, name: "ä¸‰ç‰Œé˜µ", positions: ["è¿‡å»", "ç°åœ¨", "æœªæ¥"] },
            celtic: { count: 10, name: "å‡¯å°”ç‰¹åå­—", positions: ["ç°çŠ¶", "éšœç¢", "ç›®æ ‡", "æ ¹åŸº", "è¿‡å»", "æœªæ¥", "è‡ªæˆ‘", "ç¯å¢ƒ", "å¸Œæœ›ä¸ææƒ§", "ç»“æœ"] },
            love: { count: 5, name: "çˆ±æƒ…ç‰Œé˜µ", positions: ["ä½ çš„çŠ¶æ€", "å¯¹æ–¹çŠ¶æ€", "å…³ç³»ç°çŠ¶", "æŒ‘æˆ˜", "æœªæ¥å‘å±•"] },
            work: { count: 4, name: "å·¥ä½œç‰Œé˜µ", positions: ["å½“å‰å·¥ä½œçŠ¶å†µ", "ä¼˜åŠ¿", "æŒ‘æˆ˜", "å»ºè®®"] }
        };

        let selectedSpread = 'three';
        let selectedCards = [];
        let shuffledDeck = [];
        let drawnCards = [];

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            initializeSpreadSelection();
            initializeStartButton();
            initializeNewReadingButton();
            initializeAIButton();
        });

        function initializeSpreadSelection() {
            const spreadOptions = document.querySelectorAll('.spread-option');
            spreadOptions.forEach(option => {
                option.addEventListener('click', () => {
                    spreadOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                    selectedSpread = option.dataset.spread;
                });
            });
        }

        function initializeStartButton() {
            document.getElementById('startButton').addEventListener('click', () => {
                const question = document.getElementById('question').value.trim();
                if (!question) {
                    alert('è¯·å…ˆè¾“å…¥ä½ çš„é—®é¢˜ï¼');
                    return;
                }

                // æ˜¾ç¤ºå¡ç‰‡é€‰æ‹©åŒºåŸŸ
                document.getElementById('inputSection').style.display = 'none';
                document.getElementById('cardSelectionArea').style.display = 'block';

                // åˆå§‹åŒ–å¡ç‰‡é€‰æ‹©
                initializeCardSelection();
            });
        }

        function initializeCardSelection() {
            const spread = SPREADS[selectedSpread];
            const selectionCount = document.getElementById('selectionCount');
            selectionCount.textContent = `å·²é€‰: 0 / ${spread.count}`;

            // æ´—ç‰Œ
            shuffledDeck = [...TAROT_DECK].sort(() => Math.random() - 0.5);
            selectedCards = [];

            // åˆ›å»ºç‰ŒèƒŒ
            const cardDeck = document.getElementById('cardDeck');
            cardDeck.innerHTML = '';

            shuffledDeck.forEach((card, index) => {
                const container = document.createElement('div');
                container.style.textAlign = 'center';

                const cardBack = document.createElement('div');
                cardBack.className = 'card-back';
                cardBack.dataset.index = index;

                const positionLabel = document.createElement('div');
                positionLabel.className = 'card-position-label';

                cardBack.addEventListener('click', () => toggleCardSelection(index, cardBack, positionLabel));

                container.appendChild(cardBack);
                container.appendChild(positionLabel);
                cardDeck.appendChild(container);
            });

            // ç¡®è®¤æŒ‰é’®
            const confirmButton = document.getElementById('confirmButton');
            confirmButton.onclick = confirmSelection;
        }

        function toggleCardSelection(index, cardBack, positionLabel) {
            const spread = SPREADS[selectedSpread];
            const cardIndex = selectedCards.findIndex(c => c.index === index);

            if (cardIndex !== -1) {
                // å–æ¶ˆé€‰æ‹©
                selectedCards.splice(cardIndex, 1);
                cardBack.classList.remove('selected');
                positionLabel.textContent = '';
            } else {
                // æ£€æŸ¥æ˜¯å¦å·²è¾¾ä¸Šé™
                if (selectedCards.length >= spread.count) {
                    alert(`è¯·åªé€‰æ‹© ${spread.count} å¼ ç‰Œï¼`);
                    return;
                }

                // æ·»åŠ é€‰æ‹©
                const position = spread.positions[selectedCards.length];
                selectedCards.push({ index, position });
                cardBack.classList.add('selected');
                positionLabel.textContent = `ã€${position}ã€‘`;
            }

            // æ›´æ–°è®¡æ•°
            const selectionCount = document.getElementById('selectionCount');
            selectionCount.textContent = `å·²é€‰: ${selectedCards.length} / ${spread.count}`;

            // æ›´æ–°ç¡®è®¤æŒ‰é’®
            document.getElementById('confirmButton').disabled = selectedCards.length !== spread.count;
        }

        function confirmSelection() {
            const spread = SPREADS[selectedSpread];

            // ç”ŸæˆæŠ½å–çš„ç‰Œ
            drawnCards = selectedCards.map(({ index, position }) => {
                const card = { ...shuffledDeck[index] };
                card.isReversed = Math.random() < 0.5;
                card.position = position;
                return card;
            });

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('cardSelectionArea').style.display = 'none';
            document.getElementById('resultsArea').style.display = 'block';

            displayDrawnCards();
            displayInterpretation();
        }

        function displayDrawnCards() {
            const drawnCardsContainer = document.getElementById('drawnCards');
            drawnCardsContainer.innerHTML = '';

            drawnCards.forEach((card, index) => {
                const container = document.createElement('div');
                container.className = 'card-container';
                container.style.animationDelay = `${index * 0.2}s`;

                const tarotCard = document.createElement('div');
                tarotCard.className = 'tarot-card' + (card.isReversed ? ' reversed' : '');

                tarotCard.innerHTML = `
                    <div class="card-suit">${card.symbol}</div>
                    <div class="card-name">${card.name}</div>
                    <div class="card-keywords">
                        ${card.keywords.map(kw => `<span class="keyword">${kw}</span>`).join('')}
                    </div>
                    <div class="card-status ${card.isReversed ? 'reversed-status' : ''}">
                        ${card.isReversed ? 'é€†ä½' : 'æ­£ä½'}
                    </div>
                `;

                const position = document.createElement('div');
                position.className = 'card-position';
                position.textContent = `ã€${card.position}ã€‘`;

                container.appendChild(tarotCard);
                container.appendChild(position);
                drawnCardsContainer.appendChild(container);
            });
        }

        function displayInterpretation() {
            const question = document.getElementById('question').value.trim();
            const spread = SPREADS[selectedSpread];
            const interpretation = document.getElementById('interpretation');

            let html = `
                <h2>ğŸ”® å åœè§£è¯» ğŸ”®</h2>
                <p><strong>é—®é¢˜ï¼š</strong>${question}</p>
                <p><strong>ç‰Œé˜µï¼š</strong>${spread.name}</p>
                <hr style="border: 1px solid #8E44AD; margin: 20px 0;">
            `;

            drawnCards.forEach(card => {
                const meaning = card.isReversed ? card.reversed : card.upright;
                html += `
                    <div class="card-detail">
                        <h3>ã€${card.position}ã€‘${card.name} (${card.isReversed ? 'é€†ä½' : 'æ­£ä½'})</h3>
                        <p><strong>ç‰Œç»„ï¼š</strong>${card.suit}</p>
                        <p><strong>å…³é”®è¯ï¼š</strong>${card.keywords.join('ã€')}</p>
                        <p><strong>å«ä¹‰ï¼š</strong>${meaning}</p>
                    </div>
                `;
            });

            html += `
                <div class="summary-section">
                    <h3>âœ¨ ç»¼åˆè§£è¯» âœ¨</h3>
                    <p>${generateSummary()}</p>
                </div>
            `;

            interpretation.innerHTML = html;
        }

        function generateSummary() {
            const spread = SPREADS[selectedSpread];

            if (selectedSpread === 'single') {
                const card = drawnCards[0];
                return `è¿™å¼ ${card.name}ä»£è¡¨äº†ä½ å½“å‰çš„çŠ¶å†µã€‚${card.isReversed ? 'é€†ä½çš„èƒ½é‡æé†’ä½ éœ€è¦å…³æ³¨å†…åœ¨çš„é˜»ç¢å’ŒæŒ‘æˆ˜ï¼Œ' : 'æ­£ä½çš„èƒ½é‡ä¸ºä½ å¸¦æ¥ç§¯æçš„æŒ‡å¼•ï¼Œ'}è¯·ç»“åˆç‰Œé¢å«ä¹‰æ·±å…¥æ€è€ƒï¼Œå®ƒä¸ºä½ æ­ç¤ºäº†é‡è¦çš„ä¿¡æ¯ã€‚`;
            } else if (selectedSpread === 'three') {
                return `ä»æ—¶é—´çº¿æ¥çœ‹ï¼Œ${drawnCards[0].isReversed ? 'è¿‡å»å­˜åœ¨ä¸€äº›éœ€è¦é‡Šæ”¾çš„æ¨¡å¼' : 'è¿‡å»ä¸ºç°åœ¨å¥ å®šäº†åŸºç¡€'}ã€‚ç°åœ¨ï¼Œ${drawnCards[1].name}æç¤ºä½ å½“å‰çš„ç„¦ç‚¹æ‰€åœ¨ã€‚${drawnCards[2].isReversed ? 'æœªæ¥éœ€è¦ä½ ä¸»åŠ¨è½¬å˜æ–¹å‘ä»¥è·å¾—æ›´å¥½çš„ç»“æœ' : 'æœªæ¥å±•ç°å‡ºç§¯æçš„å‘å±•è¶‹åŠ¿'}ã€‚è¯·å°†è¿™ä¸‰å¼ ç‰Œä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥ç†è§£ä½ çš„äººç”Ÿæ—…ç¨‹ã€‚`;
            } else if (selectedSpread === 'celtic') {
                return `å‡¯å°”ç‰¹åå­—ç‰Œé˜µä¸ºä½ å±•ç°äº†å®Œæ•´çš„ç”Ÿå‘½å›¾æ™¯ã€‚ä»ç°çŠ¶åˆ°æ ¹åŸºï¼Œä»éšœç¢åˆ°æœªæ¥ï¼Œæ¯ä¸€å¼ ç‰Œéƒ½åœ¨è¯‰è¯´ç€ä¸åŒçš„æ•…äº‹ã€‚è¯·ä»”ç»†é˜…è¯»æ¯ä¸ªä½ç½®çš„å«ä¹‰ï¼Œå®ƒä»¬å…±åŒç¼–ç»‡å‡ºä½ å½“å‰äººç”Ÿé˜¶æ®µçš„å…¨è²Œã€‚ç‰¹åˆ«å…³æ³¨"ç»“æœ"ä½ç½®çš„ç‰Œï¼Œå®ƒæ˜¾ç¤ºäº†å¦‚æœç»§ç»­å½“å‰çš„è·¯å¾„ä¼šèµ°å‘ä½•æ–¹ã€‚`;
            } else if (selectedSpread === 'love') {
                return `è¿™ä¸ªçˆ±æƒ…ç‰Œé˜µæ­ç¤ºäº†å…³ç³»ä¸­åŒæ–¹çš„èƒ½é‡çŠ¶æ€ã€‚ä½ å’Œå¯¹æ–¹å„è‡ªå¸¦ç€ä¸åŒçš„èƒ½é‡è¿›å…¥è¿™æ®µå…³ç³»ï¼Œå½“å‰çš„çŠ¶å†µæ˜¯ä¸¤ç§èƒ½é‡çš„äº¤æ±‡ã€‚æŒ‘æˆ˜ç‰Œæç¤ºéœ€è¦å…±åŒé¢å¯¹çš„è¯¾é¢˜ï¼Œè€Œæœªæ¥çš„å‘å±•å–å†³äºä½ ä»¬å¦‚ä½•åº”å¯¹å½“å‰çš„æŒ‘æˆ˜ã€‚çˆ±éœ€è¦ç†è§£ã€è€å¿ƒå’Œæˆé•¿ã€‚`;
            } else if (selectedSpread === 'work') {
                return `å·¥ä½œç‰Œé˜µä¸ºä½ çš„èŒä¸šå‘å±•æä¾›æ´è§ã€‚ä½ çš„ä¼˜åŠ¿æ˜¯å¯ä»¥å‘æŒ¥çš„èµ„æºï¼ŒæŒ‘æˆ˜æ˜¯éœ€è¦å…‹æœçš„éšœç¢ã€‚å»ºè®®ç‰Œæä¾›äº†å®é™…çš„è¡ŒåŠ¨æ–¹å‘ã€‚è®°ä½ï¼Œäº‹ä¸šçš„æˆåŠŸéœ€è¦ç­–ç•¥ã€åŠªåŠ›å’Œæ­£ç¡®çš„æ—¶æœºã€‚è¯·å°†è¿™äº›å»ºè®®èå…¥ä½ çš„èŒä¸šè§„åˆ’ä¸­ã€‚`;
            }

            return 'æ„¿å¡”ç½—ç‰Œçš„æ™ºæ…§ä¸ºä½ å¸¦æ¥å¯å‘ä¸æŒ‡å¼•ã€‚';
        }

        function initializeNewReadingButton() {
            document.getElementById('newReadingButton').addEventListener('click', () => {
                // é‡ç½®æ‰€æœ‰çŠ¶æ€
                document.getElementById('question').value = '';
                document.getElementById('inputSection').style.display = 'block';
                document.getElementById('cardSelectionArea').style.display = 'none';
                document.getElementById('resultsArea').style.display = 'none';
                selectedCards = [];
                drawnCards = [];

                // æ»šåŠ¨åˆ°é¡¶éƒ¨
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        function initializeAIButton() {
            document.getElementById('aiButton').addEventListener('click', () => {
                if (drawnCards.length === 0) {
                    alert('è¯·å…ˆæŠ½ç‰Œï¼');
                    return;
                }

                const question = document.getElementById('question').value.trim();
                const spread = SPREADS[selectedSpread];

                // æ„å»ºè¯¦ç»†çš„å åœä¿¡æ¯
                let readingInfo = `æˆ‘æ­£åœ¨è¿›è¡Œå¡”ç½—ç‰Œå åœï¼Œæˆ‘çš„é—®é¢˜æ˜¯ï¼š${question}\n\n`;
                readingInfo += `ä½¿ç”¨çš„ç‰Œé˜µï¼š${spread.name}\n\n`;
                readingInfo += `æŠ½åˆ°çš„ç‰Œå¦‚ä¸‹ï¼š\n`;

                drawnCards.forEach(card => {
                    const status = card.isReversed ? 'é€†ä½' : 'æ­£ä½';
                    const meaning = card.isReversed ? card.reversed : card.upright;

                    readingInfo += `\nã€${card.position}ã€‘\n`;
                    readingInfo += `ç‰Œåï¼š${card.name} (${status})\n`;
                    readingInfo += `ç‰Œç»„ï¼š${card.suit}\n`;
                    readingInfo += `å…³é”®è¯ï¼š${card.keywords.join('ã€')}\n`;
                    readingInfo += `å«ä¹‰ï¼š${meaning}\n`;
                });

                readingInfo += `\n\nè¯·ä½œä¸ºä¸€ä½ç»éªŒä¸°å¯Œçš„å¡”ç½—å¸ˆï¼Œä¸ºæˆ‘æä¾›æ·±å…¥ã€è¯¦ç»†çš„ç»¼åˆè§£è¯»ã€‚è¯·ç»“åˆæ‰€æœ‰ç‰Œçš„å«ä¹‰ã€ä½ç½®å’Œæˆ‘çš„é—®é¢˜ï¼Œç»™å‡ºæœ‰æ´å¯ŸåŠ›çš„åˆ†æå’Œå»ºè®®ã€‚`;

                // æ„å»ºè±†åŒ…å¯¹è¯URL
                const prompt = encodeURIComponent(readingInfo);
                const doubaoUrl = `https://www.doubao.com/chat/?q=${prompt}`;

                // åœ¨æ–°çª—å£æ‰“å¼€è±†åŒ…
                try {
                    window.open(doubaoUrl, '_blank');

                    // æ˜¾ç¤ºæç¤º
                    setTimeout(() => {
                        alert('å·²åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€è±†åŒ…AIï¼\n\nè±†åŒ…å°†ä¸ºæ‚¨æä¾›æ›´æ·±å…¥çš„å¡”ç½—ç‰Œè§£è¯»ã€‚\nè¯·åœ¨æ–°çª—å£ä¸­æŸ¥çœ‹AIçš„è¯¦ç»†åˆ†æã€‚');
                    }, 500);
                } catch (e) {
                    alert('æ— æ³•æ‰“å¼€æµè§ˆå™¨ï¼š' + e.message);
                }
            });
        }
    </script>
</body>
</html>