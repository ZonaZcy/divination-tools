<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>大衍之数 - 蓍草占卜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SimSun', 'STSong', serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #d4af37;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 2px solid #d4af37;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 3em;
            color: #d4af37;
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
            margin-bottom: 10px;
            letter-spacing: 8px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #c9a961;
            letter-spacing: 4px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #d4af37;
            border-radius: 15px;
            padding: 30px;
            height: fit-content;
        }

        .divination-area {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #d4af37;
            border-radius: 15px;
            padding: 30px;
            min-height: 500px;
        }

        .question-input {
            margin-bottom: 30px;
        }

        .question-input label {
            display: block;
            margin-bottom: 10px;
            font-size: 1.1em;
            color: #d4af37;
        }

        .question-input textarea {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #d4af37;
            border-radius: 8px;
            color: #d4af37;
            font-size: 1em;
            font-family: 'SimSun', serif;
            resize: vertical;
            min-height: 100px;
        }

        .start-button {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #d4af37 0%, #c9a961 100%);
            border: none;
            border-radius: 10px;
            color: #1a1a2e;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            letter-spacing: 4px;
            font-family: 'SimSun', serif;
        }

        .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.4);
        }

        .start-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .hexagram-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .hexagram-lines {
            display: flex;
            flex-direction: column-reverse;
            gap: 15px;
        }

        .hexagram-line {
            display: flex;
            align-items: center;
            gap: 15px;
            opacity: 0;
            animation: fadeInLine 0.5s forwards;
        }

        @keyframes fadeInLine {
            to { opacity: 1; }
        }

        .line-number {
            color: #c9a961;
            font-size: 0.9em;
            width: 30px;
            text-align: right;
        }

        .line-visual {
            width: 300px;
            height: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            position: relative;
        }

        .line-segment {
            height: 6px;
            background: #d4af37;
            border-radius: 3px;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
            transition: all 0.3s;
        }

        .yang-line .line-segment {
            width: 100%;
        }

        .yin-line .line-segment {
            width: 45%;
        }

        .changing-mark {
            position: absolute;
            color: #ff6b6b;
            font-size: 1.5em;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
        }

        .process-info {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #d4af37;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            font-size: 0.95em;
            line-height: 1.8;
        }

        .process-step {
            margin: 10px 0;
            padding-left: 20px;
            position: relative;
        }

        .process-step::before {
            content: "▸";
            position: absolute;
            left: 0;
            color: #d4af37;
        }

        .hexagram-name {
            font-size: 2em;
            color: #d4af37;
            text-align: center;
            margin: 20px 0;
            letter-spacing: 6px;
        }

        .interpretation {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #d4af37;
            border-radius: 10px;
            padding: 25px;
            line-height: 2;
        }

        .interpretation h3 {
            color: #d4af37;
            margin-bottom: 15px;
            margin-top: 25px;
            font-size: 1.3em;
            letter-spacing: 3px;
        }

        .interpretation h4 {
            color: #d4af37;
            margin: 0;
            font-size: 1.1em;
            letter-spacing: 2px;
        }

        .interpretation p {
            margin-bottom: 15px;
            text-indent: 2em;
        }

        .stalks-animation {
            display: flex;
            justify-content: center;
            gap: 2px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stalk {
            width: 3px;
            height: 40px;
            background: linear-gradient(to bottom, #8b7355, #654321);
            border-radius: 2px;
            animation: stalkFall 0.5s ease-out;
        }

        @keyframes stalkFall {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #d4af37, #c9a961);
            width: 0%;
            transition: width 0.5s;
        }

        .info-panel {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #d4af37;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
        }

        .info-panel h2 {
            color: #d4af37;
            margin-bottom: 20px;
            letter-spacing: 4px;
        }

        .info-panel ol {
            padding-left: 25px;
            line-height: 2;
        }

        .info-panel li {
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 2em;
                letter-spacing: 4px;
            }

            .line-visual {
                width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>大衍之数</h1>
            <p class="subtitle">蓍草占卜 · 古法占筮</p>
        </header>

        <div class="main-content">
            <div class="control-panel">
                <div class="question-input">
                    <label for="question">请输入您的问题：</label>
                    <textarea id="question" placeholder="静心诚意，输入您所求问之事..."></textarea>
                </div>
                <button class="start-button" id="startBtn">开始占卜</button>
                <div class="progress-bar" id="progressBar" style="display: none;">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div class="divination-area" id="divinationArea">
                <div style="text-align: center; color: #c9a961; padding: 50px 20px; line-height: 2;">
                    <p style="font-size: 1.2em; margin-bottom: 20px;">🌿 蓍草占卜 🌿</p>
                    <p>大衍之数五十，其用四十有九</p>
                    <p>分而为二以象两，挂一以象三</p>
                    <p>揲之以四以象四时，归奇于扐以象闰</p>
                    <p style="margin-top: 30px; font-size: 0.9em;">静心凝神，诚心求问，点击"开始占卜"</p>
                </div>
            </div>
        </div>

        <div class="info-panel">
            <h2>占卜说明</h2>
            <ol>
                <li><strong>大衍之数：</strong>取蓍草五十根，实用四十九根，象征天地之数</li>
                <li><strong>三变成爻：</strong>每一爻需经过三次演算（十八变成卦，六爻共需十八变）</li>
                <li><strong>四营之法：</strong>分二、挂一、揲四、归奇，模拟天地四时之运行</li>
                <li><strong>解卦之法：</strong>根据朱熹《易学启蒙》，依动爻多少判断吉凶</li>
                <li><strong>诚心求问：</strong>占卜贵在诚心，心诚则灵，不诚则不占</li>
            </ol>
        </div>
    </div>

    <script>
        // 内嵌的爻辞数据（从 zhouyi.json 提取）
        const LINE_DATA = {
  "000000-0": { text: "履霜坚冰至", xiang: "履霜坚冰阴始凝也驯致其道至坚冰也" },
  "000000-1": { text: "直方大不习无不利", xiang: "六二之动直以方也不习无不利地道光也" },
  "000000-2": { text: "含章可贞或从王事无成有终", xiang: "含章可贞以时发也或从王事知光大也" },
  "000000-3": { text: "括囊无咎无誉", xiang: "括囊无咎慎不害也" },
  "000000-4": { text: "黄裳元吉", xiang: "黄裳元吉文在中也" },
  "000000-5": { text: "龙战于野其血玄黄", xiang: "龙战于野其道穷也" },
  "000001-0": { text: "剥床以足蔑贞凶", xiang: "剥床以足以灭下也" },
  "000001-1": { text: "剥床以辨蔑贞凶", xiang: "剥床以辨未有与也" },
  "000001-2": { text: "剥之无咎", xiang: "剥之无咎失上下也" },
  "000001-3": { text: "剥床以肤凶", xiang: "剥床以肤切近灾也" },
  "000001-4": { text: "贯鱼以宫人宠无不利", xiang: "以宫人宠终无尤也" },
  "000001-5": { text: "硕果不食君子得舆小人剥庐", xiang: "君子得舆民所载也小人剥庐终不可用也" },
  "000010-0": { text: "有孚比之无咎有孚盈缶终来有他吉", xiang: "比之初六有他吉也" },
  "000010-1": { text: "比之自内贞吉", xiang: "比之自内不自失也" },
  "000010-2": { text: "比之匪人", xiang: "比之匪人不亦伤乎" },
  "000010-3": { text: "外比之贞吉", xiang: "外比于贤以从上也" },
  "000010-4": { text: "显比王用三驱失前禽邑人不诫吉", xiang: "显比之吉位正中也舍逆取顺失前禽也邑人不诫上使中也" },
  "000010-5": { text: "比之无首凶", xiang: "比之无首无所终也" },
  "000011-0": { text: "童观小人无咎君子吝", xiang: "初六童观小人道也" },
  "000011-1": { text: "窥观利女贞", xiang: "窥观女贞亦可丑也" },
  "000011-2": { text: "观我生进退", xiang: "观我生进退未失道也" },
  "000011-3": { text: "观国之光利用宾于王", xiang: "观国之光尚宾也" },
  "000011-4": { text: "观我生君子无咎", xiang: "观我生观民也" },
  "000011-5": { text: "观其生君子无咎", xiang: "观其生志未平也" },
  "000100-0": { text: "鸣豫凶", xiang: "初六鸣豫志穷凶也" },
  "000100-1": { text: "介于石不终日贞吉", xiang: "不终日贞吉以中正也" },
  "000100-2": { text: "盱豫悔迟有悔", xiang: "盱豫有悔位不当也" },
  "000100-3": { text: "由豫大有得勿疑朋盍簪", xiang: "由豫大有得志大行也" },
  "000100-4": { text: "贞疾恒不死", xiang: "六五贞疾乘刚也恒不死中未亡也" },
  "000100-5": { text: "冥豫成有渝无咎", xiang: "冥豫在上何可长也" },
  "000101-0": { text: "晋如摧如贞吉罔孚裕无咎", xiang: "晋如摧如独行正也裕无咎未受命也" },
  "000101-1": { text: "晋如愁如贞吉受兹介福于其王母", xiang: "受兹介福以中正也" },
  "000101-2": { text: "众允悔亡", xiang: "众允之志上行也" },
  "000101-3": { text: "晋如硕鼠贞厉", xiang: "硕鼠贞厉位不当也" },
  "000101-4": { text: "悔亡失得勿恤往吉无不利", xiang: "失得勿恤往有庆也" },
  "000101-5": { text: "晋其角维用伐邑厉吉无咎贞吝", xiang: "维用伐邑道未光也" },
  "000110-0": { text: "有孚不终乃乱乃萃若号一握为笑勿恤往无咎", xiang: "乃乱乃萃其志乱也" },
  "000110-1": { text: "引吉无咎孚乃利用禴", xiang: "引吉无咎中未变也" },
  "000110-2": { text: "萃如嗟如无攸利往无咎小吝", xiang: "往无咎上巽也" },
  "000110-3": { text: "大吉无咎", xiang: "大吉无咎位不当也" },
  "000110-4": { text: "萃有位无咎匪孚元永贞悔亡", xiang: "萃有位志未光也" },
  "000110-5": { text: "赍咨涕洟无咎", xiang: "赍咨涕洟未安上也" },
  "000111-0": { text: "拔茅茹以其汇贞吉亨", xiang: "拔茅贞吉志在君也" },
  "000111-1": { text: "包承小人吉大人否亨", xiang: "大人否亨不乱群也" },
  "000111-2": { text: "包羞", xiang: "包羞位不当也" },
  "000111-3": { text: "有命无咎畴离祉", xiang: "有命无咎志行也" },
  "000111-4": { text: "休否大人吉其亡其亡系于苞桑", xiang: "大人之吉位正当也" },
  "000111-5": { text: "倾否先否后喜", xiang: "否终则倾何可长也" },
  "001000-0": { text: "谦谦君子用涉大川吉", xiang: "谦谦君子卑以自牧也" },
  "001000-1": { text: "鸣谦贞吉", xiang: "鸣谦贞吉中心得也" },
  "001000-2": { text: "劳谦君子有终吉", xiang: "劳谦君子万民服也" },
  "001000-3": { text: "无不利撝谦", xiang: "无不利撝谦不违则也" },
  "001000-4": { text: "不富以其邻利用侵伐无不利", xiang: "利用侵伐征不服也" },
  "001000-5": { text: "鸣谦利用行师征邑国", xiang: "鸣谦志未得也可用行师征邑国也" },
  "001001-0": { text: "艮其趾无咎利永贞", xiang: "艮其趾未失正也" },
  "001001-1": { text: "艮其腓不拯其随其心不快", xiang: "不拯其随未退听也" },
  "001001-2": { text: "艮其限列其夤厉薰心", xiang: "艮其限危薰心也" },
  "001001-3": { text: "艮其身无咎", xiang: "艮其身止诸躬也" },
  "001001-4": { text: "艮其辅言有序悔亡", xiang: "艮其辅以中正也" },
  "001001-5": { text: "敦艮吉", xiang: "敦艮之吉以厚终也" },
  "001010-0": { text: "往蹇来誉", xiang: "往蹇来誉宜待也" },
  "001010-1": { text: "王臣蹇蹇匪躬之故", xiang: "王臣蹇蹇终无尤也" },
  "001010-2": { text: "往蹇来反", xiang: "往蹇来反内喜之也" },
  "001010-3": { text: "往蹇来连", xiang: "往蹇来连当位实也" },
  "001010-4": { text: "大蹇朋来", xiang: "大蹇朋来以中节也" },
  "001010-5": { text: "往蹇来硕吉利见大人", xiang: "往蹇来硕志在内也利见大人以从贵也" },
  "001011-0": { text: "鸿渐于干小子厉有言无咎", xiang: "小子之厉义无咎也" },
  "001011-1": { text: "鸿渐于磐饮食衎衎吉", xiang: "饮食衎衎不素饱也" },
  "001011-2": { text: "鸿渐于陆夫征不复妇孕不育凶利御寇", xiang: "夫征不复离群丑也妇孕不育失其道也利用御寇顺相保也" },
  "001011-3": { text: "鸿渐于木或得其桷无咎", xiang: "或得其桷顺以巽也" },
  "001011-4": { text: "鸿渐于陵妇三岁不孕终莫之胜吉", xiang: "终莫之胜吉得所愿也" },
  "001011-5": { text: "鸿渐于陆其羽可用为仪吉", xiang: "其羽可用为仪吉不可乱也" },
  "001100-0": { text: "飞鸟以凶", xiang: "飞鸟以凶不可如何也" },
  "001100-1": { text: "过其祖遇其妣不及其君遇其臣无咎", xiang: "不及其君臣不可过也" },
  "001100-2": { text: "弗过防之从或戕之凶", xiang: "从或戕之凶如何也" },
  "001100-3": { text: "无咎弗过遇之往厉必戒勿用永贞", xiang: "弗过遇之位不当也往厉必戒终不可长也" },
  "001100-4": { text: "密云不雨自我西郊公弋取彼在穴", xiang: "密云不雨已上也" },
  "001100-5": { text: "弗遇过之飞鸟离之凶是谓灾眚", xiang: "弗遇过之已亢也" },
  "001101-0": { text: "旅琐琐斯其所取灾", xiang: "旅琐琐志穷灾也" },
  "001101-1": { text: "旅即次怀其资得童仆贞", xiang: "得童仆贞终无尤也" },
  "001101-2": { text: "旅焚其次丧其童仆贞厉", xiang: "旅焚其次亦以伤矣以旅与下其义丧也" },
  "001101-3": { text: "旅于处得其资斧我心不快", xiang: "旅于处未得位也得其资斧心未快也" },
  "001101-4": { text: "射雉一矢亡终以誉命", xiang: "终以誉命上逮也" },
  "001101-5": { text: "鸟焚其巢旅人先笑后号啕丧牛于易凶", xiang: "以旅在上其义焚也丧牛于易终莫之闻也" },
  "001110-0": { text: "咸其拇", xiang: "咸其拇志在外也" },
  "001110-1": { text: "咸其腓凶居吉", xiang: "虽凶居吉顺不害也" },
  "001110-2": { text: "咸其股执其随往吝", xiang: "咸其股亦不处也志在随人所执下也" },
  "001110-3": { text: "贞吉悔亡憧憧往来朋从尔思", xiang: "贞吉悔亡未感害也憧憧往来未光大也" },
  "001110-4": { text: "咸其脢无悔", xiang: "咸其脢志末也" },
  "001110-5": { text: "咸其辅颊舌", xiang: "咸其辅颊舌滕口说也" },
  "001111-0": { text: "遁尾厉勿用有攸往", xiang: "遁尾之厉不往何灾也" },
  "001111-1": { text: "执之用黄牛之革莫之胜说", xiang: "执用黄牛固志也" },
  "001111-2": { text: "系遁有疾厉畜臣妾吉", xiang: "系遁之厉有疾惫也畜臣妾吉不可大事也" },
  "001111-3": { text: "好遁君子吉小人否", xiang: "君子好遁小人否也" },
  "001111-4": { text: "嘉遁贞吉", xiang: "嘉遁贞吉以正志也" },
  "001111-5": { text: "肥遁无不利", xiang: "肥遁无不利无所疑也" },
  "010000-0": { text: "师出以律否臧凶", xiang: "师出以律失律凶也" },
  "010000-1": { text: "在师中吉无咎王三锡命", xiang: "在师中吉承天宠也王三锡命怀万邦也" },
  "010000-2": { text: "师或舆尸凶", xiang: "师或舆尸大无功也" },
  "010000-3": { text: "师左次无咎", xiang: "左次无咎未失常也" },
  "010000-4": { text: "田有禽利执言无咎长子帅师弟子舆尸贞凶", xiang: "长子帅师以中行也弟子舆尸使不当也" },
  "010000-5": { text: "大君有命开国承家小人勿用", xiang: "大君有命以正功也小人勿用必乱邦也" },
  "010001-0": { text: "发蒙利用刑人用说桎梏以往吝", xiang: "利用刑人以正法也" },
  "010001-1": { text: "包蒙吉纳妇吉子克家", xiang: "子克家刚柔接也" },
  "010001-2": { text: "勿用取女见金夫不有躬无攸利", xiang: "勿用取女行不顺也" },
  "010001-3": { text: "困蒙吝", xiang: "困蒙之吝独远实也" },
  "010001-4": { text: "童蒙吉", xiang: "童蒙之吉顺以巽也" },
  "010001-5": { text: "击蒙不利为寇利御寇", xiang: "利用御寇上下顺也" },
  "010010-0": { text: "习坎入于坎窞凶", xiang: "习坎入坎失道凶也" },
  "010010-1": { text: "坎有险求小得", xiang: "求小得未出中也" },
  "010010-2": { text: "来之坎坎险且枕入于坎窞勿用", xiang: "来之坎坎终无功也" },
  "010010-3": { text: "樽酒簋贰用缶纳约自牖终无咎", xiang: "樽酒簋贰刚柔际也" },
  "010010-4": { text: "坎不盈祗既平无咎", xiang: "坎不盈中未大也" },
  "010010-5": { text: "系用徽纆窴于丛棘三岁不得凶", xiang: "上六失道凶三岁也" },
  "010011-0": { text: "用拯马壮吉", xiang: "初六之吉顺也" },
  "010011-1": { text: "涣奔其机悔亡", xiang: "涣奔其机得愿也" },
  "010011-2": { text: "涣其躬无悔", xiang: "涣其躬志在外也" },
  "010011-3": { text: "涣其群元吉涣有丘匪夷所思", xiang: "涣其群元吉光大也" },
  "010011-4": { text: "涣汗其大号涣王居无咎", xiang: "王居无咎正位也" },
  "010011-5": { text: "涣其血去逖出无咎", xiang: "涣其血远害也" },
  "010100-0": { text: "无咎", xiang: "刚柔之际义无咎也" },
  "010100-1": { text: "田获三狐得黄矢贞吉", xiang: "九二贞吉得中道也" },
  "010100-2": { text: "负且乘致寇至贞吝", xiang: "负且乘亦可丑也自我致戎又谁咎也" },
  "010100-3": { text: "解而拇朋至斯孚", xiang: "解而拇未当位也" },
  "010100-4": { text: "君子维有解吉有孚于小人", xiang: "君子有解小人退也" },
  "010100-5": { text: "公用射隼于高墉之上获之无不利", xiang: "公用射隼以解悖也" },
  "010101-0": { text: "濡其尾吝", xiang: "濡其尾亦不知极也" },
  "010101-1": { text: "曳其轮贞吉", xiang: "九二贞吉中以行正也" },
  "010101-2": { text: "未济征凶利涉大川", xiang: "未济征凶位不当也" },
  "010101-3": { text: "贞吉悔亡震用伐鬼方三年有赏于大国", xiang: "贞吉悔亡志行也" },
  "010101-4": { text: "贞吉无悔君子之光有孚吉", xiang: "君子之光其晖吉也" },
  "010101-5": { text: "有孚于饮酒无咎濡其首有孚失是", xiang: "饮酒濡首亦不知节也" },
  "010110-0": { text: "臀困于株木入于幽谷三岁不见", xiang: "入于幽谷幽不明也" },
  "010110-1": { text: "困于酒食朱绂方来利用亨祀征凶无咎", xiang: "困于酒食中有庆也" },
  "010110-2": { text: "困于石据于蒺藜入于其宫不见其妻凶", xiang: "据于蒺藜乘刚也入于其宫不见其妻不祥也" },
  "010110-3": { text: "来徐徐困于金车吝有终", xiang: "来徐徐志在下也虽不当位有与也" },
  "010110-4": { text: "劓刖困于赤绂乃徐有说利用祭祀", xiang: "劓刖志未得也乃徐有说以中直也利用祭祀受福也" },
  "010110-5": { text: "困于葛藟于臲卼曰动悔有悔征吉", xiang: "困于葛藟未当也动悔有悔吉行也" },
  "010111-0": { text: "不永所事小有言终吉", xiang: "不永所事讼不可长也虽小有言其辩明也" },
  "010111-1": { text: "不克讼归而逋其邑人三百户无眚", xiang: "不克讼归逋窜也自下讼上患至掇也" },
  "010111-2": { text: "食旧德贞厉终吉或从王事无成", xiang: "食旧德从上吉也" },
  "010111-3": { text: "不克讼复即命渝安贞吉", xiang: "复即命渝安贞不失也" },
  "010111-4": { text: "讼元吉", xiang: "讼元吉以中正也" },
  "010111-5": { text: "或锡之鞶带终朝三褫之", xiang: "以讼受服亦不足敬也" },
  "011000-0": { text: "允升大吉", xiang: "允升大吉上合志也" },
  "011000-1": { text: "孚乃利用禴无咎", xiang: "九二之孚有喜也" },
  "011000-2": { text: "升虚邑", xiang: "升虚邑无所疑也" },
  "011000-3": { text: "王用亨于岐山吉无咎", xiang: "王用亨于岐山顺事也" },
  "011000-4": { text: "贞吉升阶", xiang: "贞吉升阶大得志也" },
  "011000-5": { text: "冥升利于不息之贞", xiang: "冥升在上消不富也" },
  "011001-0": { text: "干父之蛊有子考无咎厉终吉", xiang: "干父之蛊意承考也" },
  "011001-1": { text: "干母之蛊不可贞", xiang: "干母之蛊得中道也" },
  "011001-2": { text: "干父之蛊小有悔无大咎", xiang: "干父之蛊终无咎也" },
  "011001-3": { text: "裕父之蛊往见吝", xiang: "裕父之蛊往未得也" },
  "011001-4": { text: "干父之蛊用誉", xiang: "干父之蛊承以德也" },
  "011001-5": { text: "不事王侯高尚其事", xiang: "不事王侯志可则也" },
  "011010-0": { text: "井泥不食旧井无禽", xiang: "井泥不食下也旧井无禽时舍也" },
  "011010-1": { text: "井谷射鲋瓮敝漏", xiang: "井谷射鲋无与也" },
  "011010-2": { text: "井渫不食为我心恻可用汲王明并受其福", xiang: "井渫不食行恻也求王明受福也" },
  "011010-3": { text: "井甃无咎", xiang: "井甃无咎修井也" },
  "011010-4": { text: "井冽寒泉食", xiang: "寒泉之食中正也" },
  "011010-5": { text: "井收勿幕有孚元吉", xiang: "元吉在上大成也" },
  "011011-0": { text: "进退利武人之贞", xiang: "进退志疑也利武人之贞志治也" },
  "011011-1": { text: "巽在床下用史巫纷若吉无咎", xiang: "纷若之吉得中也" },
  "011011-2": { text: "频巽吝", xiang: "频巽之吝志穷也" },
  "011011-3": { text: "悔亡田获三品", xiang: "田获三品有功也" },
  "011011-4": { text: "贞吉悔亡无不利无初有终先庚三日后庚三日吉", xiang: "九五之吉位正中也" },
  "011011-5": { text: "巽在床下丧其资斧贞凶", xiang: "巽在床下上穷也丧其资斧正乎凶也" },
  "011100-0": { text: "浚恒贞凶无攸利", xiang: "浚恒之凶始求深也" },
  "011100-1": { text: "悔亡", xiang: "九二悔亡能久中也" },
  "011100-2": { text: "不恒其德或承之羞贞吝", xiang: "不恒其德无所容也" },
  "011100-3": { text: "田无禽", xiang: "久非其位安得禽也" },
  "011100-4": { text: "恒其德贞妇人吉夫子凶", xiang: "妇人贞吉从一而终也夫子制义从妇凶也" },
  "011100-5": { text: "振恒凶", xiang: "振恒在上大无功也" },
  "011101-0": { text: "鼎颠趾利出否得妾以其子无咎", xiang: "鼎颠趾未悖也利出否以从贵也" },
  "011101-1": { text: "鼎有实我仇有疾不我能即吉", xiang: "鼎有实慎所之也我仇有疾终无尤也" },
  "011101-2": { text: "鼎耳革其行塞雉膏不食方雨亏悔终吉", xiang: "鼎耳革失其义也" },
  "011101-3": { text: "鼎折足覆公餗其形渥凶", xiang: "覆公餗信如何也" },
  "011101-4": { text: "鼎黄耳金铉利贞", xiang: "鼎黄耳中以为实也" },
  "011101-5": { text: "鼎玉铉大吉无不利", xiang: "玉铉在上刚柔节也" },
  "011110-0": { text: "藉用白茅无咎", xiang: "藉用白茅柔在下也" },
  "011110-1": { text: "枯杨生稊老夫得其女妻无不利", xiang: "老夫女妻过以相与也" },
  "011110-2": { text: "栋桡凶", xiang: "栋桡之凶不可以有辅也" },
  "011110-3": { text: "栋隆吉有它吝", xiang: "栋隆之吉不桡乎下也" },
  "011110-4": { text: "枯杨生华老妇得其士夫无咎无誉", xiang: "枯杨生华何可久也老妇士夫亦可丑也" },
  "011110-5": { text: "过涉灭顶凶无咎", xiang: "过涉之凶不可咎也" },
  "011111-0": { text: "系于金柅贞吉有攸往见凶羸豕孚踟蹰", xiang: "系于金柅柔道牵也" },
  "011111-1": { text: "包有鱼无咎不利宾", xiang: "包有鱼义不及宾也" },
  "011111-2": { text: "臀无肤其行次且厉无大咎", xiang: "其行次且行未牵也" },
  "011111-3": { text: "包无鱼起凶", xiang: "无鱼之凶远民也" },
  "011111-4": { text: "以杞包瓜含章有陨自天", xiang: "九五含章中正也有陨自天志不舍命也" },
  "011111-5": { text: "姤其角吝无咎", xiang: "姤其角上穷吝也" },
  "100000-0": { text: "不远复无祗悔元吉", xiang: "不远之复以修身也" },
  "100000-1": { text: "休复吉", xiang: "休复之吉以下仁也" },
  "100000-2": { text: "频复厉无咎", xiang: "频复之厉义无咎也" },
  "100000-3": { text: "中行独复", xiang: "中行独复以从道也" },
  "100000-4": { text: "敦复无悔", xiang: "敦复无悔中以自考也" },
  "100000-5": { text: "迷复凶有灾眚用行师终有大败以其国君凶至于十年不克征", xiang: "迷复之凶反君道也" },
  "100001-0": { text: "舍尔灵龟观我朵颐凶", xiang: "观我朵颐亦不足贵也" },
  "100001-1": { text: "颠颐拂经于丘颐征凶", xiang: "六二征凶行失类也" },
  "100001-2": { text: "拂颐贞凶十年勿用无攸利", xiang: "十年勿用道大悖也" },
  "100001-3": { text: "颠颐吉虎视眈眈其欲逐逐无咎", xiang: "颠颐之吉上施光也" },
  "100001-4": { text: "拂经居贞吉不可涉大川", xiang: "居贞之吉顺以从上也" },
  "100001-5": { text: "由颐厉吉利涉大川", xiang: "由颐厉吉大有庆也" },
  "100010-0": { text: "磐桓利居贞利建侯", xiang: "虽磐桓志行正也以贵下贱大得民也" },
  "100010-1": { text: "屯如邅如乘马班如匪寇婚媾女子贞不字十年乃字", xiang: "六二之难乘刚也十年乃字反常也" },
  "100010-2": { text: "即鹿无虞惟入于林中君子几不如舍往吝", xiang: "即鹿无虞以纵禽也君子舍之往吝穷也" },
  "100010-3": { text: "乘马班如求婚媾往吉无不利", xiang: "求而往明也" },
  "100010-4": { text: "屯其膏小贞吉大贞凶", xiang: "屯其膏施未光也" },
  "100010-5": { text: "乘马班如泣血涟如", xiang: "泣血涟如何可长也" },
  "100011-0": { text: "利用为大作元吉无咎", xiang: "元吉无咎下不厚事也" },
  "100011-1": { text: "或益之十朋之龟弗克违永贞吉王用享于帝吉", xiang: "或益之自外来也" },
  "100011-2": { text: "益之用凶事无咎有孚中行告公用圭", xiang: "益用凶事固有之也" },
  "100011-3": { text: "中行告公从利用为依迁国", xiang: "告公从以益志也" },
  "100011-4": { text: "有孚惠心勿问元吉有孚惠我德", xiang: "有孚惠心勿问之矣惠我德大得志也" },
  "100011-5": { text: "莫益之或击之立心勿恒凶", xiang: "莫益之偏辞也或击之自外来也" },
  "100100-0": { text: "震来虩虩后笑言哑哑吉", xiang: "震来虩虩恐致福也笑言哑哑后有则也" },
  "100100-1": { text: "震来厉亿丧贝跻于九陵勿逐七日得", xiang: "震来厉乘刚也" },
  "100100-2": { text: "震苏苏震行无眚", xiang: "震苏苏位不当也" },
  "100100-3": { text: "震遂泥", xiang: "震遂泥未光也" },
  "100100-4": { text: "震往来厉亿无丧有事", xiang: "震往来厉危行也其事在中大无丧也" },
  "100100-5": { text: "震索索视矍矍征凶震不于其躬于其邻无咎婚媾有言", xiang: "震索索未得中也虽凶无咎畏邻戒也" },
  "100101-0": { text: "履校灭趾无咎", xiang: "履校灭趾不行也" },
  "100101-1": { text: "噬肤灭鼻无咎", xiang: "噬肤灭鼻乘刚也" },
  "100101-2": { text: "噬腊肉遇毒小吝无咎", xiang: "遇毒位不当也" },
  "100101-3": { text: "噬干胏得金矢利艰贞吉", xiang: "利艰贞吉未光也" },
  "100101-4": { text: "噬干肉得黄金贞厉无咎", xiang: "贞厉无咎得当也" },
  "100101-5": { text: "何校灭耳凶", xiang: "何校灭耳聪不明也" },
  "100110-0": { text: "官有渝贞吉出门交有功", xiang: "官有渝从正吉也出门交有功不失也" },
  "100110-1": { text: "系小子失丈夫", xiang: "系小子弗兼与也" },
  "100110-2": { text: "系丈夫失小子随有求得利居贞", xiang: "系丈夫志舍下也" },
  "100110-3": { text: "随有获贞凶有孚在道以明何咎", xiang: "随有获其义凶也有孚在道明功也" },
  "100110-4": { text: "孚于嘉吉", xiang: "孚于嘉吉位正中也" },
  "100110-5": { text: "拘系之乃从维之王用亨于西山", xiang: "拘系之上穷也" },
  "100111-0": { text: "无妄往吉", xiang: "无妄之往得志也" },
  "100111-1": { text: "不耕获不菑畬则利有攸往", xiang: "不耕获未富也" },
  "100111-2": { text: "无妄之灾或系之牛行人之得邑人之灾", xiang: "行人得牛邑人灾也" },
  "100111-3": { text: "可贞无咎", xiang: "可贞无咎固有之也" },
  "100111-4": { text: "无妄之疾勿药有喜", xiang: "无妄之药不可试也" },
  "100111-5": { text: "无妄行有眚无攸利", xiang: "无妄之行穷之灾也" },
  "101000-0": { text: "明夷于飞垂其翼君子于行三日不食有攸往主人有言", xiang: "君子于行义不食也" },
  "101000-1": { text: "明夷夷于左股用拯马壮吉", xiang: "六二之吉顺以则也" },
  "101000-2": { text: "明夷于南狩得其大首不可疾贞", xiang: "南狩之志乃大得也" },
  "101000-3": { text: "入于左腹获明夷之心于出门庭", xiang: "入于左腹获心意也" },
  "101000-4": { text: "箕子之明夷利贞", xiang: "箕子之贞明不可息也" },
  "101000-5": { text: "不明晦初登于天后入于地", xiang: "初登于天照四国也后入于地失则也" },
  "101001-0": { text: "贲其趾舍车而徒", xiang: "舍车而徒义弗乘也" },
  "101001-1": { text: "贲其须", xiang: "贲其须与上兴也" },
  "101001-2": { text: "贲如濡如永贞吉", xiang: "永贞之吉终莫之陵也" },
  "101001-3": { text: "贲如皤如白马翰如匪寇婚媾", xiang: "六四当位疑也匪寇婚媾终无尤也" },
  "101001-4": { text: "贲于丘园束帛戋戋吝终吉", xiang: "六五之吉有喜也" },
  "101001-5": { text: "白贲无咎", xiang: "白贲无咎上得志也" },
  "101010-0": { text: "曳其轮濡其尾无咎", xiang: "曳其轮义无咎也" },
  "101010-1": { text: "妇丧其茀勿逐七日得", xiang: "七日得以中道也" },
  "101010-2": { text: "高宗伐鬼方三年克之小人勿用", xiang: "三年克之惫也" },
  "101010-3": { text: "繻有衣袽终日戒", xiang: "终日戒有所疑也" },
  "101010-4": { text: "东邻杀牛不如西邻之禴祭实受其福", xiang: "东邻杀牛不如西邻之时也实受其福吉大来也" },
  "101010-5": { text: "濡其首厉", xiang: "濡其首厉何可久也" },
  "101011-0": { text: "闲有家悔亡", xiang: "闲有家志未变也" },
  "101011-1": { text: "无攸遂在中馈贞吉", xiang: "六二之吉顺以巽也" },
  "101011-2": { text: "家人嗃嗃悔厉吉妇子嘻嘻终吝", xiang: "家人嗃嗃未失也妇子嘻嘻失家节也" },
  "101011-3": { text: "富家大吉", xiang: "富家大吉顺在位也" },
  "101011-4": { text: "王假有家勿恤吉", xiang: "王假有家交相爱也" },
  "101011-5": { text: "有孚威如终吉", xiang: "威如之吉反身之谓也" },
  "101100-0": { text: "遇其配主虽旬无咎往有尚", xiang: "虽旬无咎过旬灾也" },
  "101100-1": { text: "丰其蔀日中见斗往得疑疾有孚发若吉", xiang: "有孚发若信以发志也" },
  "101100-2": { text: "丰其沛日中见昧折其右肱无咎", xiang: "丰其沛不可大事也折其右肱终不可用也" },
  "101100-3": { text: "丰其蔀日中见斗遇其夷主吉", xiang: "丰其蔀位不当也日中见斗幽不明也遇其夷主吉行也" },
  "101100-4": { text: "来章有庆誉吉", xiang: "六五之吉有庆也" },
  "101100-5": { text: "丰其屋蔀其家窥其户阒其无人三岁不见凶", xiang: "丰其屋天际翔也窥其户阒其无人自藏也" },
  "101101-0": { text: "履错然敬之无咎", xiang: "履错之敬以辟咎也" },
  "101101-1": { text: "黄离元吉", xiang: "黄离元吉得中道也" },
  "101101-2": { text: "日昃之离不鼓缶而歌则大耋之嗟凶", xiang: "日昃之离何可久也" },
  "101101-3": { text: "突如其来如焚如死如弃如", xiang: "突如其来如无所容也" },
  "101101-4": { text: "出涕沱若戚嗟若吉", xiang: "六五之吉离王公也" },
  "101101-5": { text: "王用出征有嘉折首获匪其丑无咎", xiang: "王用出征以正邦也" },
  "101110-0": { text: "巩用黄牛之革", xiang: "巩用黄牛不可以有为也" },
  "101110-1": { text: "己日乃革之征吉无咎", xiang: "己日革之行有嘉也" },
  "101110-2": { text: "征凶贞厉革言三就有孚", xiang: "革言三就又何之矣" },
  "101110-3": { text: "悔亡有孚改命吉", xiang: "改命之吉信志也" },
  "101110-4": { text: "大人虎变未占有孚", xiang: "大人虎变其文炳也" },
  "101110-5": { text: "君子豹变小人革面征凶居贞吉", xiang: "君子豹变其文蔚也小人革面顺以从君也" },
  "101111-0": { text: "同人于门无咎", xiang: "出门同人又谁咎也" },
  "101111-1": { text: "同人于宗吝", xiang: "同人于宗吝道也" },
  "101111-2": { text: "伏戎于莽升其高陵三岁不兴", xiang: "伏戎于莽敌刚也三岁不兴安行也" },
  "101111-3": { text: "乘其墉弗克攻吉", xiang: "乘其墉义弗克也其吉则困而反则也" },
  "101111-4": { text: "同人先号啕而后笑大师克相遇", xiang: "同人之先以中直也大师相遇言相克也" },
  "101111-5": { text: "同人于郊无悔", xiang: "同人于郊志未得也" },
  "110000-0": { text: "咸临贞吉", xiang: "咸临贞吉志行正也" },
  "110000-1": { text: "咸临吉无不利", xiang: "咸临吉无不利未顺命也" },
  "110000-2": { text: "甘临无攸利既忧之无咎", xiang: "甘临位不当也既忧之咎不长也" },
  "110000-3": { text: "至临无咎", xiang: "至临无咎位当也" },
  "110000-4": { text: "知临大君之宜吉", xiang: "大君之宜行中之谓也" },
  "110000-5": { text: "敦临吉无咎", xiang: "敦临之吉志在内也" },
  "110001-0": { text: "已事遄往无咎酌损之", xiang: "已事遄往尚合志也" },
  "110001-1": { text: "利贞征凶弗损益之", xiang: "九二利贞中以为志也" },
  "110001-2": { text: "三人行则损一人一人行则得其友", xiang: "一人行三则疑也" },
  "110001-3": { text: "损其疾使遄有喜无咎", xiang: "损其疾亦可喜也" },
  "110001-4": { text: "或益之十朋之龟弗克违元吉", xiang: "六五元吉自上佑也" },
  "110001-5": { text: "弗损益之无咎贞吉利有攸往得臣无家", xiang: "弗损益之大得志也" },
  "110010-0": { text: "不出户庭无咎", xiang: "不出户庭知通塞也" },
  "110010-1": { text: "不出门庭凶", xiang: "不出门庭失时极也" },
  "110010-2": { text: "不节若则嗟若无咎", xiang: "不节之嗟又谁咎也" },
  "110010-3": { text: "安节亨", xiang: "安节之亨承上道也" },
  "110010-4": { text: "甘节吉往有尚", xiang: "甘节之吉居位中也" },
  "110010-5": { text: "苦节贞凶悔亡", xiang: "苦节贞凶其道穷也" },
  "110011-0": { text: "虞吉有他不燕", xiang: "初九虞吉志未变也" },
  "110011-1": { text: "鸣鹤在阴其子和之我有好爵吾与尔靡之", xiang: "其子和之中心愿也" },
  "110011-2": { text: "得敌或鼓或罢或泣或歌", xiang: "或鼓或罢位不当也" },
  "110011-3": { text: "月几望马匹亡无咎", xiang: "马匹亡绝类上也" },
  "110011-4": { text: "有孚挛如无咎", xiang: "有孚挛如位正当也" },
  "110011-5": { text: "翰音登于天贞凶", xiang: "翰音登于天何可长也" },
  "110100-0": { text: "归妹以娣跛能履征吉", xiang: "归妹以娣以恒也跛能履吉相承也" },
  "110100-1": { text: "眇能视利幽人之贞", xiang: "利幽人之贞未变常也" },
  "110100-2": { text: "归妹以须反归以娣", xiang: "归妹以须未当也" },
  "110100-3": { text: "归妹愆期迟归有时", xiang: "愆期之志有待而行也" },
  "110100-4": { text: "帝乙归妹其君之袂不如其娣之袂良月几望吉", xiang: "帝乙归妹不如其娣之袂良也其位在中以贵行也" },
  "110100-5": { text: "女承筐无实士刲羊无血无攸利", xiang: "上六无实承虚筐也" },
  "110101-0": { text: "悔亡丧马勿逐自复见恶人无咎", xiang: "见恶人以辟咎也" },
  "110101-1": { text: "遇主于巷无咎", xiang: "遇主于巷未失道也" },
  "110101-2": { text: "见舆曳其牛掣其人天且劓无初有终", xiang: "见舆曳位不当也无初有终遇刚也" },
  "110101-3": { text: "睽孤遇元夫交孚厉无咎", xiang: "交孚无咎志行也" },
  "110101-4": { text: "悔亡厥宗噬肤往何咎", xiang: "厥宗噬肤往有庆也" },
  "110101-5": { text: "睽孤见豕负涂载鬼一车先张之弧后说之弧匪寇婚媾往遇雨则吉", xiang: "遇雨之吉群疑亡也" },
  "110110-0": { text: "和兑吉", xiang: "和兑之吉行未疑也" },
  "110110-1": { text: "孚兑吉悔亡", xiang: "孚兑之吉信志也" },
  "110110-2": { text: "来兑凶", xiang: "来兑之凶位不当也" },
  "110110-3": { text: "商兑未宁介疾有喜", xiang: "九四之喜有庆也" },
  "110110-4": { text: "孚于剥有厉", xiang: "孚于剥位正当也" },
  "110110-5": { text: "引兑", xiang: "上六引兑未光也" },
  "110111-0": { text: "素履往无咎", xiang: "素履之往独行愿也" },
  "110111-1": { text: "履道坦坦幽人贞吉", xiang: "幽人贞吉中不自乱也" },
  "110111-2": { text: "眇能视跛能履履虎尾咥人凶武人为于大君", xiang: "眇能视不足以有明也跛能履不足以与行也咥人之凶位不当也武人为于大君志刚也" },
  "110111-3": { text: "履虎尾愬愬终吉", xiang: "愬愬终吉志行也" },
  "110111-4": { text: "夬履贞厉", xiang: "夬履贞厉位正当也" },
  "110111-5": { text: "视履考祥其旋元吉", xiang: "元吉在上大有庆也" },
  "111000-0": { text: "拔茅茹以其汇征吉", xiang: "拔茅征吉志在外也" },
  "111000-1": { text: "包荒用冯河不遐遗朋亡得尚于中行", xiang: "包荒得尚于中行以光大也" },
  "111000-2": { text: "无平不陂无往不复艰贞无咎勿恤其孚于食有福", xiang: "无往不复天地际也" },
  "111000-3": { text: "翩翩不富以其邻不戒以孚", xiang: "翩翩不富皆失实也不戒以孚中心愿也" },
  "111000-4": { text: "帝乙归妹以祉元吉", xiang: "以祉元吉中以行愿也" },
  "111000-5": { text: "城复于隍勿用师自邑告命贞吝", xiang: "城复于隍其命乱也" },
  "111001-0": { text: "有厉利已", xiang: "有厉利已不犯灾也" },
  "111001-1": { text: "舆说辐", xiang: "舆说辐中无尤也" },
  "111001-2": { text: "良马逐利艰贞曰闲舆卫利有攸往", xiang: "利有攸往上合志也" },
  "111001-3": { text: "童牛之牿元吉", xiang: "六四元吉有喜也" },
  "111001-4": { text: "豮豕之牙吉", xiang: "六五之吉有庆也" },
  "111001-5": { text: "何天之衢亨", xiang: "何天之衢道大行也" },
  "111010-0": { text: "需于郊利用恒无咎", xiang: "需于郊不犯难行也利用恒无咎未失常也" },
  "111010-1": { text: "需于沙小有言终吉", xiang: "需于沙衍在中也虽小有言以终吉也" },
  "111010-2": { text: "需于泥致寇至", xiang: "需于泥灾在外也自我致寇敬慎不败也" },
  "111010-3": { text: "需于血出自穴", xiang: "需于血顺以听也" },
  "111010-4": { text: "需于酒食贞吉", xiang: "酒食贞吉以中正也" },
  "111010-5": { text: "入于穴有不速之客三人来敬之终吉", xiang: "不速之客来敬之终吉虽不当位未大失也" },
  "111011-0": { text: "复自道何其咎吉", xiang: "复自道其义吉也" },
  "111011-1": { text: "牵复吉", xiang: "牵复在中亦不自失也" },
  "111011-2": { text: "舆说辐夫妻反目", xiang: "夫妻反目不能正室也" },
  "111011-3": { text: "有孚血去惕出无咎", xiang: "有孚惕出上合志也" },
  "111011-4": { text: "有孚挛如富以其邻", xiang: "有孚挛如不独富也" },
  "111011-5": { text: "既雨既处尚德载妇贞厉月几望君子征凶", xiang: "既雨既处德积载也君子征凶有所疑也" },
  "111100-0": { text: "壮于趾征凶有孚", xiang: "壮于趾其孚穷也" },
  "111100-1": { text: "贞吉", xiang: "九二贞吉以中也" },
  "111100-2": { text: "小人用壮君子用罔贞厉羝羊触藩羸其角", xiang: "小人用壮君子罔也" },
  "111100-3": { text: "贞吉悔亡藩决不羸壮于大舆之輹", xiang: "藩决不羸尚往也" },
  "111100-4": { text: "丧羊于易无悔", xiang: "丧羊于易位不当也" },
  "111100-5": { text: "羝羊触藩不能退不能遂无攸利艰则吉", xiang: "不能退不能遂不祥也艰则吉咎不长也" },
  "111101-0": { text: "无交害匪咎艰则无咎", xiang: "大有初九无交害也" },
  "111101-1": { text: "大车以载有攸往无咎", xiang: "大车以载积中不败也" },
  "111101-2": { text: "公用亨于天子小人弗克", xiang: "公用亨于天子小人害也" },
  "111101-3": { text: "匪其彭无咎", xiang: "匪其彭无咎明辨晰也" },
  "111101-4": { text: "厥孚交如威如吉", xiang: "厥孚交如信以发志也威如之吉易而无备也" },
  "111101-5": { text: "自天佑之吉无不利", xiang: "大有上吉自天佑也" },
  "111110-0": { text: "壮于前趾往不胜为吝", xiang: "不胜而往咎也" },
  "111110-1": { text: "惕号莫夜有戎勿恤", xiang: "有戎勿恤得中道也" },
  "111110-2": { text: "壮于頄有凶君子夬夬独行遇雨若濡有愠无咎", xiang: "君子夬夬终无咎也" },
  "111110-3": { text: "臀无肤其行次且牵羊悔亡闻言不信", xiang: "其行次且位不当也闻言不信聪不明也" },
  "111110-4": { text: "苋陆夬夬中行无咎", xiang: "中行无咎中未光也" },
  "111110-5": { text: "无号终有凶", xiang: "无号之凶终不可长也" },
  "111111-0": { text: "潜龙勿用", xiang: "潜龙勿用阳在下也" },
  "111111-1": { text: "见龙在田利见大人", xiang: "见龙在田德施普也" },
  "111111-2": { text: "君子终日乾乾夕惕若厉无咎", xiang: "终日乾乾反复道也" },
  "111111-3": { text: "或跃在渊无咎", xiang: "或跃在渊进无咎也" },
  "111111-4": { text: "飞龙在天利见大人", xiang: "飞龙在天大人造也" },
  "111111-5": { text: "亢龙有悔", xiang: "亢龙有悔盈不可久也" },
};

        

        // 加载周易数据
        let zhouyiData = null;
        let hexagrams = {};

        // 初始化数据
        async function loadZhouyiData() {
            try {
                const response = await fetch('zhouyi.json');
                zhouyiData = await response.json();
                initHexagrams();
            } catch (error) {
                console.error('加载周易数据失败:', error);
                // 使用备用简化数据
                useFallbackData();
            }
        }

        function initHexagrams() {
            // 从 JSON 数据中构建卦象字典
            const hexIndexGroup = zhouyiData.g.find(g => g.t === "Hexagram Index");
            const hexNameGroup = zhouyiData.g.find(g => g.t === "Hexagram Name");
            const hexTextGroup = zhouyiData.g.find(g => g.t === "Hexagram Text");
            const xiangGroup = zhouyiData.g.find(g => g.t === "Xiang (Hexagram)");
            const tuanGroup = zhouyiData.g.find(g => g.t === "Tuan");
            const lineTextGroup = zhouyiData.g.find(g => g.t === "Line Text");
            const lineXiangGroup = zhouyiData.g.find(g => g.t === "Xiang (Line)");

            if (!hexIndexGroup || !hexNameGroup) {
                useFallbackData();
                return;
            }

            hexIndexGroup.e.forEach((entry, idx) => {
                const binary = entry.t; // 如 "111111"
                const name = hexNameGroup.e[idx]?.c || '未知';
                const text = hexTextGroup.e[idx]?.c || '';
                const xiang = xiangGroup.e[idx]?.c || '';
                const tuan = tuanGroup.e[idx]?.c || '';

                // 获取六爻的爻辞和象传（从内嵌的LINE_DATA中获取）
                const lines = [];
                for (let i = 0; i < 6; i++) {
                    const lineKey = `${binary}-${i}`;
                    const lineData = LINE_DATA[lineKey] || { text: '', xiang: '' };
                    lines.push({
                        text: lineData.text,
                        xiang: lineData.xiang
                    });
                }

                hexagrams[binary] = {
                    name: name,
                    chinese: name,
                    text: text,
                    xiang: xiang,
                    tuan: tuan,
                    lines: lines,
                    description: text ? `${text}` : ''
                };
            });

            // 调试：检查第一个卦的爻辞是否正确加载
            console.log('========== 数据加载检查 ==========');
            console.log('乾卦爻辞数组:', hexagrams['111111']?.lines);
            console.log('乾卦第一爻爻辞:', hexagrams['111111']?.lines[0]?.text);
            console.log('同人卦(101111)爻辞数组:', hexagrams['101111']?.lines);
            console.log('同人卦第2爻(索引1)爻辞:', hexagrams['101111']?.lines[1]?.text);
            console.log('LINE_DATA中同人卦第2爻:', LINE_DATA['101111-1']);
        }

        function useFallbackData() {
            // 备用简化数据 - 现在也包含爻辞（从LINE_DATA获取）
            const addLines = (binary) => {
                const lines = [];
                for (let i = 0; i < 6; i++) {
                    const lineKey = `${binary}-${i}`;
                    const lineData = LINE_DATA[lineKey] || { text: '', xiang: '' };
                    lines.push({
                        text: lineData.text,
                        xiang: lineData.xiang
                    });
                }
                return lines;
            };

            hexagrams = {
                '111111': { name: '乾', chinese: '乾', description: '元亨利贞。刚健中正，自强不息。', text: '元亨利贞', lines: addLines('111111') },
                '000000': { name: '坤', chinese: '坤', description: '元亨，利牝马之贞。柔顺承载，厚德载物。', text: '元亨利牝马之贞', lines: addLines('000000') },
                '100010': { name: '屯', chinese: '屯', description: '元亨利贞，勿用有攸往，利建侯。', text: '元亨利贞勿用有攸往利建侯', lines: addLines('100010') },
                '010001': { name: '蒙', chinese: '蒙', description: '亨。匪我求童蒙，童蒙求我。', text: '亨匪我求童蒙童蒙求我', lines: addLines('010001') },
                '111010': { name: '需', chinese: '需', description: '有孚，光亨，贞吉，利涉大川。', text: '有孚光亨贞吉利涉大川', lines: addLines('111010') },
                '010111': { name: '讼', chinese: '讼', description: '有孚，窒惕，中吉，终凶。', text: '有孚窒惕中吉终凶', lines: addLines('010111') },
                '010000': { name: '师', chinese: '师', description: '贞，丈人吉，无咎。', text: '贞丈人吉无咎', lines: addLines('010000') },
                '000010': { name: '比', chinese: '比', description: '吉。原筮，元永贞，无咎。', text: '吉原筮元永贞无咎', lines: addLines('000010') },
                '111011': { name: '小畜', chinese: '小畜', description: '亨。密云不雨。', text: '亨密云不雨自我西郊', lines: addLines('111011') },
                '110111': { name: '履', chinese: '履', description: '履虎尾，不咥人，亨。', text: '履虎尾不咥人亨', lines: addLines('110111') },
                '111000': { name: '泰', chinese: '泰', description: '小往大来，吉亨。', text: '小往大来吉亨', lines: addLines('111000') },
                '000111': { name: '否', chinese: '否', description: '否之匪人，不利君子贞。', text: '否之匪人不利君子贞大往小来', lines: addLines('000111') },
                '101111': { name: '同人', chinese: '同人', description: '同人于野，亨。', text: '同人于野亨利涉大川利君子贞', lines: addLines('101111') },
                '111101': { name: '大有', chinese: '大有', description: '元亨。', text: '元亨', lines: addLines('111101') },
                '001000': { name: '谦', chinese: '谦', description: '亨，君子有终。', text: '亨君子有终', lines: addLines('001000') },
                '000100': { name: '豫', chinese: '豫', description: '利建侯行师。', text: '利建侯行师', lines: addLines('000100') },
                '100110': { name: '随', chinese: '随', description: '元亨利贞，无咎。', text: '元亨利贞无咎', lines: addLines('100110') },
                '011001': { name: '蛊', chinese: '蛊', description: '元亨，利涉大川。', text: '元亨利涉大川', lines: addLines('011001') },
                '110000': { name: '临', chinese: '临', description: '元亨利贞。', text: '元亨利贞至于八月有凶', lines: addLines('110000') },
                '000011': { name: '观', chinese: '观', description: '盥而不荐，有孚颙若。', text: '盥而不荐有孚颙若', lines: addLines('000011') },
                '100101': { name: '噬嗑', chinese: '噬嗑', description: '亨，利用狱。', text: '亨利用狱', lines: addLines('100101') },
                '101001': { name: '贲', chinese: '贲', description: '亨，小利有攸往。', text: '亨小利有攸往', lines: addLines('101001') },
                '000001': { name: '剥', chinese: '剥', description: '不利有攸往。', text: '不利有攸往', lines: addLines('000001') },
                '100000': { name: '复', chinese: '复', description: '亨。出入无疾。', text: '亨出入无疾朋来无咎', lines: addLines('100000') },
                '100111': { name: '无妄', chinese: '无妄', description: '元亨利贞。', text: '元亨利贞其匪正有眚不利有攸往', lines: addLines('100111') },
                '111001': { name: '大畜', chinese: '大畜', description: '利贞，不家食吉。', text: '利贞不家食吉利涉大川', lines: addLines('111001') },
                '100001': { name: '颐', chinese: '颐', description: '贞吉。观颐。', text: '贞吉观颐自求口实', lines: addLines('100001') },
                '011110': { name: '大过', chinese: '大过', description: '栋桡，利有攸往，亨。', text: '栋桡利有攸往亨', lines: addLines('011110') },
                '010010': { name: '坎', chinese: '坎', description: '习坎，有孚，维心亨。', text: '有孚维心亨行有尚', lines: addLines('010010') },
                '101101': { name: '离', chinese: '离', description: '利贞，亨。畜牝牛，吉。', text: '利贞亨畜牝牛吉', lines: addLines('101101') },
                '001110': { name: '咸', chinese: '咸', description: '亨，利贞，取女吉。', text: '亨利贞取女吉', lines: addLines('001110') },
                '011100': { name: '恒', chinese: '恒', description: '亨，无咎，利贞。', text: '亨无咎利贞利有攸往', lines: addLines('011100') },
                '001111': { name: '遁', chinese: '遁', description: '亨，小利贞。', text: '亨小利贞', lines: addLines('001111') },
                '111100': { name: '大壮', chinese: '大壮', description: '利贞。', text: '利贞', lines: addLines('111100') },
                '000101': { name: '晋', chinese: '晋', description: '康侯用锡马蕃庶。', text: '康侯用锡马蕃庶昼日三接', lines: addLines('000101') },
                '101000': { name: '明夷', chinese: '明夷', description: '利艰贞。', text: '利艰贞', lines: addLines('101000') },
                '101011': { name: '家人', chinese: '家人', description: '利女贞。', text: '利女贞', lines: addLines('101011') },
                '110101': { name: '睽', chinese: '睽', description: '小事吉。', text: '小事吉', lines: addLines('110101') },
                '001010': { name: '蹇', chinese: '蹇', description: '利西南，不利东北。', text: '利西南不利东北利见大人贞吉', lines: addLines('001010') },
                '010100': { name: '解', chinese: '解', description: '利西南。', text: '利西南无所往其来复吉', lines: addLines('010100') },
                '110001': { name: '损', chinese: '损', description: '有孚，元吉。', text: '有孚元吉无咎可贞利有攸往', lines: addLines('110001') },
                '100011': { name: '益', chinese: '益', description: '利有攸往，利涉大川。', text: '利有攸往利涉大川', lines: addLines('100011') },
                '111110': { name: '夬', chinese: '夬', description: '扬于王庭。', text: '扬于王庭孚号有厉', lines: addLines('111110') },
                '011111': { name: '姤', chinese: '姤', description: '女壮，勿用取女。', text: '女壮勿用取女', lines: addLines('011111') },
                '000110': { name: '萃', chinese: '萃', description: '亨，王假有庙。', text: '亨王假有庙利见大人亨利贞', lines: addLines('000110') },
                '011000': { name: '升', chinese: '升', description: '元亨，用见大人。', text: '元亨用见大人勿恤南征吉', lines: addLines('011000') },
                '010110': { name: '困', chinese: '困', description: '亨，贞，大人吉。', text: '亨贞大人吉无咎', lines: addLines('010110') },
                '011010': { name: '井', chinese: '井', description: '改邑不改井。', text: '改邑不改井无丧无得往来井井', lines: addLines('011010') },
                '101110': { name: '革', chinese: '革', description: '己日乃孚，元亨利贞。', text: '己日乃孚元亨利贞悔亡', lines: addLines('101110') },
                '011101': { name: '鼎', chinese: '鼎', description: '元吉，亨。', text: '元吉亨', lines: addLines('011101') },
                '100100': { name: '震', chinese: '震', description: '亨。震来虩虩。', text: '亨震来虩虩笑言哑哑', lines: addLines('100100') },
                '001001': { name: '艮', chinese: '艮', description: '艮其背，不获其身。', text: '艮其背不获其身行其庭不见其人无咎', lines: addLines('001001') },
                '001011': { name: '渐', chinese: '渐', description: '女归吉，利贞。', text: '女归吉利贞', lines: addLines('001011') },
                '110100': { name: '归妹', chinese: '归妹', description: '征凶，无攸利。', text: '征凶无攸利', lines: addLines('110100') },
                '101100': { name: '丰', chinese: '丰', description: '亨，王假之。', text: '亨王假之勿忧宜日中', lines: addLines('101100') },
                '001101': { name: '旅', chinese: '旅', description: '小亨，旅贞吉。', text: '小亨旅贞吉', lines: addLines('001101') },
                '011011': { name: '巽', chinese: '巽', description: '小亨，利有攸往。', text: '小亨利有攸往利见大人', lines: addLines('011011') },
                '110110': { name: '兑', chinese: '兑', description: '亨，利贞。', text: '亨利贞', lines: addLines('110110') },
                '010011': { name: '涣', chinese: '涣', description: '亨。王假有庙。', text: '亨王假有庙利涉大川利贞', lines: addLines('010011') },
                '110010': { name: '节', chinese: '节', description: '亨。苦节不可贞。', text: '亨苦节不可贞', lines: addLines('110010') },
                '110011': { name: '中孚', chinese: '中孚', description: '豚鱼吉，利涉大川。', text: '豚鱼吉利涉大川利贞', lines: addLines('110011') },
                '001100': { name: '小过', chinese: '小过', description: '亨，利贞。', text: '亨利贞可小事不可大事', lines: addLines('001100') },
                '101010': { name: '既济', chinese: '既济', description: '亨小，利贞。', text: '亨小利贞初吉终乱', lines: addLines('101010') },
                '010101': { name: '未济', chinese: '未济', description: '亨，小狐汔济。', text: '亨小狐汔济濡其尾无攸利', lines: addLines('010101') }
            };
        }

        // 页面加载时初始化数据
        loadZhouyiData();

        class YarrowDivination {
            constructor() {
                this.lines = [];
                this.currentLine = 0;
                this.isRunning = false;
            }

            // 一次变化过程（四营）
            singleChange(stalks) {
                // 1. 分而为二
                const rightGroup = Math.floor(Math.random() * (stalks - 1)) + 1;
                const leftGroup = stalks - rightGroup;

                // 2. 挂一（从右组取一根）
                let right = rightGroup - 1;
                let left = leftGroup;

                // 3. 揲之以四（左组）
                const leftRemainder = left % 4 || 4;
                left -= leftRemainder;

                // 4. 揲之以四（右组）
                const rightRemainder = right % 4 || 4;
                right -= rightRemainder;

                // 归奇于扐（左手指间的筹策数）
                const removed = 1 + leftRemainder + rightRemainder; // 挂一 + 左余 + 右余

                return {
                    remaining: left + right,
                    removed: removed
                };
            }

            // 三变成一爻
            async getOneLine() {
                let stalks = 49;
                const changes = [];

                // 第一变
                let result = this.singleChange(stalks);
                changes.push(result);
                stalks = result.remaining;

                // 第二变
                result = this.singleChange(stalks);
                changes.push(result);
                stalks = result.remaining;

                // 第三变
                result = this.singleChange(stalks);
                changes.push(result);
                stalks = result.remaining;

                // 根据最终余数确定爻的性质
                // 可能的余数：24, 28, 32, 36
                let lineType;
                if (stalks === 24) {
                    lineType = { value: 1, type: 'old_yang', name: '老阳', changing: true }; // 老阳（九）
                } else if (stalks === 28) {
                    lineType = { value: 0, type: 'old_yin', name: '老阴', changing: true }; // 老阴（六）
                } else if (stalks === 32) {
                    lineType = { value: 1, type: 'young_yang', name: '少阳', changing: false }; // 少阳（七）
                } else { // 36
                    lineType = { value: 0, type: 'young_yin', name: '少阴', changing: false }; // 少阴（八）
                }

                return {
                    line: lineType,
                    stalks: stalks,
                    changes: changes
                };
            }

            // 完整占卜（六爻）
            async performDivination(callback) {
                this.lines = [];
                this.currentLine = 0;
                this.isRunning = true;

                for (let i = 0; i < 6; i++) {
                    if (!this.isRunning) break;

                    const result = await this.getOneLine();
                    this.lines.push(result);
                    this.currentLine = i + 1;

                    if (callback) {
                        await callback(i, result);
                    }

                    await this.sleep(800);
                }

                return this.lines;
            }

            getHexagram() {
                const binary = this.lines.map(l => l.line.value).join('');
                return hexagrams[binary] || { name: '未知卦象', chinese: '?', description: '卦象未找到' };
            }

            getChangedHexagram() {
                const changed = this.lines.map(l =>
                    l.line.changing ? (l.line.value === 1 ? 0 : 1) : l.line.value
                ).join('');
                return hexagrams[changed] || null;
            }

            getChangingLines() {
                return this.lines.map((l, i) => l.line.changing ? i : -1).filter(i => i >= 0);
            }

            getInterpretation() {
                const changingCount = this.getChangingLines().length;
                const changingLines = this.getChangingLines();
                const originalHex = this.getHexagram();
                const changedHex = this.getChangedHexagram();

                console.log('============ 断卦分析 ============');
                console.log('动爻数量:', changingCount);
                console.log('动爻位置:', changingLines);
                console.log('本卦:', originalHex.chinese);
                console.log('本卦lines数组:', originalHex.lines);
                console.log('本卦lines是否存在:', !!originalHex.lines);
                console.log('本卦lines长度:', originalHex.lines?.length);
                if (changedHex) {
                    console.log('变卦:', changedHex.chinese);
                    console.log('变卦lines数组:', changedHex.lines);
                    console.log('变卦lines是否存在:', !!changedHex.lines);
                    console.log('变卦lines长度:', changedHex.lines?.length);
                }
                if (changingLines.length > 0) {
                    changingLines.forEach(lineIdx => {
                        console.log(`第${lineIdx + 1}爻（动）:`, originalHex.lines?.[lineIdx]);
                    });
                }

                let method = '';
                let lineTexts = '';

                if (changingCount === 0) {
                    method = '六爻安静：以本卦卦辞判断';
                    lineTexts = '';
                } else if (changingCount === 1) {
                    const lineNum = changingLines[0];
                    method = '一爻动：以本卦动爻爻辞判断';
                    const lineData = originalHex.lines?.[lineNum];
                    lineTexts = `
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <h4 style="color: #d4af37; margin-bottom: 10px;">本卦【${originalHex.chinese}】第${lineNum + 1}爻</h4>
                            <p style="text-indent: 0;">${lineData?.text || ''}</p>
                            ${lineData?.xiang ? `<p style="text-indent: 0; color: #c9a961; margin-top: 8px;"><em>小象：${lineData.xiang}</em></p>` : ''}
                        </div>
                    `;
                } else if (changingCount === 2) {
                    const upperLine = Math.max(...changingLines);
                    const lowerLine = Math.min(...changingLines);
                    method = '二爻动：以本卦两动爻爻辞判断，以上爻为主';
                    const upperData = originalHex.lines?.[upperLine];
                    const lowerData = originalHex.lines?.[lowerLine];
                    lineTexts = `
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <h4 style="color: #ff6b6b; margin-bottom: 10px;">本卦【${originalHex.chinese}】第${upperLine + 1}爻（上爻，为主）</h4>
                            <p style="text-indent: 0;">${upperData?.text || ''}</p>
                            ${upperData?.xiang ? `<p style="text-indent: 0; color: #c9a961; margin-top: 8px;"><em>小象：${upperData.xiang}</em></p>` : ''}
                        </div>
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <h4 style="color: #d4af37; margin-bottom: 10px;">本卦【${originalHex.chinese}】第${lowerLine + 1}爻</h4>
                            <p style="text-indent: 0;">${lowerData?.text || ''}</p>
                            ${lowerData?.xiang ? `<p style="text-indent: 0; color: #c9a961; margin-top: 8px;"><em>小象：${lowerData.xiang}</em></p>` : ''}
                        </div>
                    `;
                } else if (changingCount === 3) {
                    method = '三爻动：以本卦和变卦的卦辞判断，以本卦为主';
                    lineTexts = '';
                } else if (changingCount === 4) {
                    method = '四爻动：以变卦二静爻爻辞判断，以下爻为主';
                    // 找出两个静爻
                    const staticLines = [0, 1, 2, 3, 4, 5].filter(i => !changingLines.includes(i));
                    const lowerStatic = Math.min(...staticLines);
                    const upperStatic = Math.max(...staticLines);
                    const lowerData = changedHex?.lines?.[lowerStatic];
                    const upperData = changedHex?.lines?.[upperStatic];

                    lineTexts = `
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <h4 style="color: #ff6b6b; margin-bottom: 10px;">变卦【${changedHex.chinese}】第${lowerStatic + 1}爻（下爻，为主）</h4>
                            <p style="text-indent: 0;">${lowerData?.text || ''}</p>
                            ${lowerData?.xiang ? `<p style="text-indent: 0; color: #c9a961; margin-top: 8px;"><em>小象：${lowerData.xiang}</em></p>` : ''}
                        </div>
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <h4 style="color: #d4af37; margin-bottom: 10px;">变卦【${changedHex.chinese}】第${upperStatic + 1}爻</h4>
                            <p style="text-indent: 0;">${upperData?.text || ''}</p>
                            ${upperData?.xiang ? `<p style="text-indent: 0; color: #c9a961; margin-top: 8px;"><em>小象：${upperData.xiang}</em></p>` : ''}
                        </div>
                    `;
                } else if (changingCount === 5) {
                    method = '五爻动：以变卦静爻爻辞判断';
                    // 找出唯一的静爻
                    const staticLine = [0, 1, 2, 3, 4, 5].find(i => !changingLines.includes(i));
                    const lineData = changedHex?.lines?.[staticLine];

                    console.log('========== 五爻动调试 ==========');
                    console.log('静爻位置:', staticLine);
                    console.log('变卦:', changedHex);
                    console.log('变卦.lines:', changedHex?.lines);
                    console.log('静爻数据:', lineData);
                    console.log('爻辞文本:', lineData?.text);

                    lineTexts = `
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <h4 style="color: #d4af37; margin-bottom: 10px;">变卦【${changedHex.chinese}】第${staticLine + 1}爻（静爻）</h4>
                            <p style="text-indent: 0;">${lineData?.text || '❌爻辞加载失败'}</p>
                            ${lineData?.xiang ? `<p style="text-indent: 0; color: #c9a961; margin-top: 8px;"><em>小象：${lineData.xiang}</em></p>` : ''}
                        </div>
                    `;
                } else {
                    method = '六爻全动：以变卦卦辞判断';
                    const original = this.lines.map(l => l.line.value).join('');
                    if (original === '111111' || original === '000000') {
                        lineTexts = `
                            <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-top: 10px;">
                                <p style="text-indent: 0;">乾卦用九：群龙无首，吉</p>
                                <p style="text-indent: 0; margin-top: 8px;">坤卦用六：利永贞</p>
                            </div>
                        `;
                    } else {
                        lineTexts = '';
                    }
                }

                return {
                    method: method,
                    lineTexts: lineTexts,
                    original: originalHex,
                    changed: changedHex,
                    changingCount: changingCount
                };
            }

            sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            stop() {
                this.isRunning = false;
            }
        }

        // UI控制
        const startBtn = document.getElementById('startBtn');
        const divinationArea = document.getElementById('divinationArea');
        const progressBar = document.getElementById('progressBar');
        const progressFill = document.getElementById('progressFill');
        const questionInput = document.getElementById('question');

        const divination = new YarrowDivination();

        startBtn.addEventListener('click', async () => {
            const question = questionInput.value.trim();
            if (!question) {
                alert('请先输入您的问题');
                return;
            }

            startBtn.disabled = true;
            progressBar.style.display = 'block';
            divinationArea.innerHTML = '';

            // 创建显示区域
            const hexagramDisplay = document.createElement('div');
            hexagramDisplay.className = 'hexagram-display';
            hexagramDisplay.innerHTML = `
                <div class="process-info">
                    <div style="text-align: center; font-size: 1.2em; margin-bottom: 15px;">
                        问：${question}
                    </div>
                    <div id="processText">正在起卦...</div>
                </div>
                <div class="hexagram-lines" id="hexagramLines"></div>
            `;
            divinationArea.appendChild(hexagramDisplay);

            const processText = document.getElementById('processText');
            const hexagramLines = document.getElementById('hexagramLines');

            await divination.performDivination(async (lineIndex, result) => {
                // 更新进度
                const progress = ((lineIndex + 1) / 6) * 100;
                progressFill.style.width = progress + '%';

                // 更新过程信息
                processText.innerHTML = `
                    <div class="process-step">第${lineIndex + 1}爻：三变完成</div>
                    <div class="process-step">最终余策：${result.stalks}根</div>
                    <div class="process-step">爻象：${result.line.name}${result.line.changing ? '（动爻）' : ''}</div>
                `;

                // 添加爻线
                const lineDiv = document.createElement('div');
                lineDiv.className = 'hexagram-line';
                lineDiv.style.animationDelay = '0s';

                const isYang = result.line.value === 1;
                lineDiv.innerHTML = `
                    <span class="line-number">${lineIndex + 1}</span>
                    <div class="line-visual ${isYang ? 'yang-line' : 'yin-line'}">
                        ${isYang
                            ? '<div class="line-segment"></div>'
                            : '<div class="line-segment"></div><div class="line-segment"></div>'}
                        ${result.line.changing ? '<span class="changing-mark">○</span>' : ''}
                    </div>
                    <span style="color: ${result.line.changing ? '#ff6b6b' : '#c9a961'};">
                        ${result.line.name}
                    </span>
                `;
                hexagramLines.appendChild(lineDiv);
            });

            // 显示卦象和解释
            await divination.sleep(500);

            const interpretation = divination.getInterpretation();
            const changedHex = divination.getChangedHexagram();

            const resultDiv = document.createElement('div');
            resultDiv.style.animationDelay = '0.3s';

            // 构建解读内容
            let interpretationHTML = `
                <div class="hexagram-name">☰ ${interpretation.original.name} ☷</div>
                ${interpretation.changingCount > 0 ?
                    `<div style="text-align: center; color: #ff6b6b; margin: 10px 0;">
                        ${interpretation.changingCount}爻发动 → 之卦：${changedHex.name}
                    </div>` : ''}
                <div class="interpretation">
                    <h3>卦象</h3>
                    <p><strong>本卦【${interpretation.original.name}】：</strong>${interpretation.original.text || interpretation.original.description}</p>
            `;

            // 如果有变卦，显示变卦信息
            if (interpretation.changingCount > 0 && changedHex) {
                interpretationHTML += `
                    <p style="margin-top: 10px;"><strong>之卦【${changedHex.name}】：</strong>${changedHex.text || changedHex.description}</p>
                `;
            }

            interpretationHTML += `
                    <h3>断卦</h3>
                    <p style="text-indent: 0;"><strong>${interpretation.method}</strong></p>
                    ${interpretation.lineTexts || ''}
                    <p style="text-indent: 0; margin-top: 20px; padding-top: 20px; border-top: 1px solid #d4af37; color: #c9a961; font-size: 0.9em;">
                        ※ 占卜之道，贵在诚心。卦象只是参考，最终还需结合实际情况，以智慧判断，以行动践行。
                    </p>
                </div>
            `;

            resultDiv.innerHTML = interpretationHTML;
            divinationArea.appendChild(resultDiv);

            startBtn.disabled = false;
            progressBar.style.display = 'none';
            progressFill.style.width = '0%';
        });
    </script>
</body>
</html>